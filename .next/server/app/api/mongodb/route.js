/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/mongodb/route";
exports.ids = ["app/api/mongodb/route"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?32c4":
/*!****************************!*\
  !*** bufferutil (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "?66e9":
/*!********************************!*\
  !*** utf-8-validate (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmongodb%2Froute&page=%2Fapi%2Fmongodb%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmongodb%2Froute.ts&appDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmongodb%2Froute&page=%2Fapi%2Fmongodb%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmongodb%2Froute.ts&appDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_otaviomarco_Desktop_Projetos_Global_Live_kratodeliv_cardapio_latest_src_app_api_mongodb_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/mongodb/route.ts */ \"(rsc)/./src/app/api/mongodb/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/mongodb/route\",\n        pathname: \"/api/mongodb\",\n        filename: \"route\",\n        bundlePath: \"app/api/mongodb/route\"\n    },\n    resolvedPagePath: \"/Users/otaviomarco/Desktop/Projetos/Global Live/kratodeliv/cardapio_latest/src/app/api/mongodb/route.ts\",\n    nextConfigOutput,\n    userland: _Users_otaviomarco_Desktop_Projetos_Global_Live_kratodeliv_cardapio_latest_src_app_api_mongodb_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZtb25nb2RiJTJGcm91dGUmcGFnZT0lMkZhcGklMkZtb25nb2RiJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbW9uZ29kYiUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm90YXZpb21hcmNvJTJGRGVza3RvcCUyRlByb2pldG9zJTJGR2xvYmFsJTIwTGl2ZSUyRmtyYXRvZGVsaXYlMkZjYXJkYXBpb19sYXRlc3QlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGb3RhdmlvbWFyY28lMkZEZXNrdG9wJTJGUHJvamV0b3MlMkZHbG9iYWwlMjBMaXZlJTJGa3JhdG9kZWxpdiUyRmNhcmRhcGlvX2xhdGVzdCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD1zdGFuZGFsb25lJnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ3VEO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix5R0FBbUI7QUFDM0M7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsc0RBQXNEO0FBQzlEO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzBGOztBQUUxRiIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvb3RhdmlvbWFyY28vRGVza3RvcC9Qcm9qZXRvcy9HbG9iYWwgTGl2ZS9rcmF0b2RlbGl2L2NhcmRhcGlvX2xhdGVzdC9zcmMvYXBwL2FwaS9tb25nb2RiL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcInN0YW5kYWxvbmVcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvbW9uZ29kYi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL21vbmdvZGJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL21vbmdvZGIvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvb3RhdmlvbWFyY28vRGVza3RvcC9Qcm9qZXRvcy9HbG9iYWwgTGl2ZS9rcmF0b2RlbGl2L2NhcmRhcGlvX2xhdGVzdC9zcmMvYXBwL2FwaS9tb25nb2RiL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmongodb%2Froute&page=%2Fapi%2Fmongodb%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmongodb%2Froute.ts&appDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/mongodb/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/mongodb/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/mongodb-services */ \"(rsc)/./src/lib/mongodb-services.ts\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/mongodb */ \"(rsc)/./src/lib/mongodb.ts\");\n\n\n\n\nasync function GET(request) {\n    const searchParams = request.nextUrl.searchParams;\n    const action = searchParams.get('action');\n    try {\n        switch(action){\n            case 'getCategories':\n                const restaurantId = searchParams.get('restaurantId');\n                const categoryIds = searchParams.get('ids');\n                if (categoryIds) {\n                    // Buscar categorias específicas por IDs\n                    try {\n                        // Conecta ao MongoDB\n                        const client = await _lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"];\n                        const db = client.db('cardapio_digital');\n                        // Converte a string de IDs em um array\n                        const idArray = categoryIds.split(',');\n                        // Converte os IDs em ObjectIds para a consulta\n                        const objectIds = idArray.map((id)=>{\n                            try {\n                                return new mongodb__WEBPACK_IMPORTED_MODULE_2__.ObjectId(id);\n                            } catch (error) {\n                                console.error(`ID inválido: ${id}`);\n                                return null;\n                            }\n                        }).filter((id)=>id !== null);\n                        // Busca as categorias pelo ID\n                        const categories = await db.collection('categories').find({\n                            _id: {\n                                $in: objectIds\n                            }\n                        }).toArray();\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(categories);\n                    } catch (error) {\n                        console.error('Erro ao buscar categorias por IDs:', error);\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                            error: 'Erro ao buscar categorias'\n                        }, {\n                            status: 500\n                        });\n                    }\n                }\n                // Caso tradicional: buscar categorias por restaurante\n                if (!restaurantId) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'restaurantId é obrigatório'\n                    }, {\n                        status: 400\n                    });\n                }\n                const categories = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.getCategories)(restaurantId);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(categories);\n            case 'getProducts':\n                const restaurantIdForProducts = searchParams.get('restaurantId');\n                if (!restaurantIdForProducts) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'restaurantId é obrigatório'\n                    }, {\n                        status: 400\n                    });\n                }\n                const products = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.getProducts)(restaurantIdForProducts);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(products);\n            case 'getOrders':\n                const restaurantIdForOrders = searchParams.get('restaurantId');\n                if (!restaurantIdForOrders) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'restaurantId é obrigatório'\n                    }, {\n                        status: 400\n                    });\n                }\n                console.log('API: Buscando pedidos para restaurantId:', restaurantIdForOrders);\n                const orders = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.getOrders)(restaurantIdForOrders);\n                console.log(`API: ${orders.length} pedidos encontrados`);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(orders);\n            case 'getOrder':\n                const orderId = searchParams.get('id');\n                if (!orderId) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'id é obrigatório'\n                    }, {\n                        status: 400\n                    });\n                }\n                const order = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.getOrder)(orderId);\n                // Adiciona categorias aos itens do pedido que não as têm\n                if (order && order.items && Array.isArray(order.items)) {\n                    // Verifica quais itens precisam de categorias\n                    const itemsWithoutCategory = order.items.filter((item)=>!item.category);\n                    const hasUpdates = itemsWithoutCategory.length > 0;\n                    if (hasUpdates) {\n                        console.log(`Encontrados ${itemsWithoutCategory.length} itens sem categoria no pedido ${orderId}`);\n                        // Buscar produtos para obter categorias\n                        try {\n                            const client = await _lib_mongodb__WEBPACK_IMPORTED_MODULE_3__[\"default\"];\n                            const db = client.db('cardapio_digital');\n                            const productsCollection = db.collection('products');\n                            const categoriesCollection = db.collection('categories');\n                            const ordersCollection = db.collection('orders');\n                            let hasChanges = false;\n                            for (const item of order.items){\n                                if (!item.category) {\n                                    console.log(`Buscando categoria para item \"${item.name}\" (ID: ${item.productId})`);\n                                    // Tenta encontrar o produto pelo ID\n                                    let product;\n                                    try {\n                                        product = await productsCollection.findOne({\n                                            $or: [\n                                                {\n                                                    _id: new mongodb__WEBPACK_IMPORTED_MODULE_2__.ObjectId(item.productId)\n                                                },\n                                                {\n                                                    id: item.productId\n                                                },\n                                                {\n                                                    productId: item.productId\n                                                }\n                                            ]\n                                        });\n                                        if (product) {\n                                            console.log(`Encontrado produto para item '${item.name}': ${product.name}`);\n                                        } else {\n                                            // Busca por nome se não encontrar por ID\n                                            product = await productsCollection.findOne({\n                                                name: item.name\n                                            });\n                                            if (product) {\n                                                console.log(`Encontrado produto pelo nome: ${product.name}`);\n                                            }\n                                        }\n                                    } catch (e) {\n                                        console.log(`Erro ao buscar produto pelo ID ${item.productId}`, e);\n                                    }\n                                    if (product) {\n                                        let categoryName = null;\n                                        // Tenta obter a categoria de várias fontes\n                                        if (product.category) {\n                                            // Se o produto já tem a categoria diretamente\n                                            categoryName = product.category;\n                                            console.log(`Categoria do produto: ${categoryName}`);\n                                        } else if (product.categoryId) {\n                                            // Se o produto tem um categoryId, busca a categoria\n                                            try {\n                                                const category = await categoriesCollection.findOne({\n                                                    $or: [\n                                                        {\n                                                            _id: new mongodb__WEBPACK_IMPORTED_MODULE_2__.ObjectId(product.categoryId)\n                                                        },\n                                                        {\n                                                            id: product.categoryId\n                                                        }\n                                                    ]\n                                                });\n                                                if (category) {\n                                                    categoryName = category.name;\n                                                    console.log(`Categoria encontrada pelo ID: ${categoryName}`);\n                                                }\n                                            } catch (e) {\n                                                console.log(`Erro ao buscar categoria pelo ID ${product.categoryId}`, e);\n                                            }\n                                        } else if (product.categoryName) {\n                                            // Alguns produtos podem ter categoryName direto\n                                            categoryName = product.categoryName;\n                                            console.log(`Usando categoryName do produto: ${categoryName}`);\n                                        }\n                                        if (categoryName) {\n                                            // Atualiza o item em memória\n                                            item.category = categoryName;\n                                            hasChanges = true;\n                                            // Atualiza no banco de dados também\n                                            try {\n                                                const updateResult = await ordersCollection.updateOne({\n                                                    _id: new mongodb__WEBPACK_IMPORTED_MODULE_2__.ObjectId(orderId),\n                                                    \"items.productId\": item.productId\n                                                }, {\n                                                    $set: {\n                                                        \"items.$.category\": categoryName\n                                                    }\n                                                });\n                                                console.log(`Atualização no banco: ${updateResult.modifiedCount} item(s) modificado(s)`);\n                                            } catch (updateError) {\n                                                console.error(\"Erro ao atualizar categoria no banco:\", updateError);\n                                            }\n                                        } else {\n                                            console.log(`Não foi possível determinar a categoria para o item '${item.name}'`);\n                                        }\n                                    } else {\n                                        console.log(`Produto não encontrado para item '${item.name}'`);\n                                    }\n                                }\n                            }\n                            if (hasChanges) {\n                                console.log(\"Categorias atualizadas com sucesso para o pedido:\", orderId);\n                            }\n                        } catch (error) {\n                            console.error('Erro ao enriquecer pedido com categorias:', error);\n                        }\n                    }\n                }\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(order);\n            case 'getDashboardStats':\n                {\n                    const restaurantIdForStats = searchParams.get('restaurantId');\n                    if (!restaurantIdForStats) {\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                            error: 'restaurantId é obrigatório'\n                        }, {\n                            status: 400\n                        });\n                    }\n                    try {\n                        const stats = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.getDashboardStats)(restaurantIdForStats);\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(stats);\n                    } catch (error) {\n                        console.error('Erro ao buscar estatísticas do dashboard:', error);\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                            error: 'Erro ao buscar estatísticas do dashboard'\n                        }, {\n                            status: 500\n                        });\n                    }\n                }\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Ação inválida'\n                }, {\n                    status: 400\n                });\n        }\n    } catch (error) {\n        console.error('Erro na API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Erro interno do servidor'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    const searchParams = request.nextUrl.searchParams;\n    const action = searchParams.get('action');\n    try {\n        const body = await request.json();\n        switch(action){\n            case 'createCategory':\n                const newCategory = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.createCategory)(body);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(newCategory);\n            case 'updateCategory':\n                try {\n                    const { id: categoryId, ...categoryData } = body;\n                    console.log('Atualizando categoria na API:', {\n                        categoryId,\n                        categoryData\n                    });\n                    if (!categoryId) {\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                            error: 'ID da categoria é obrigatório'\n                        }, {\n                            status: 400\n                        });\n                    }\n                    const result = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.updateCategory)(categoryId, categoryData);\n                    console.log('Categoria atualizada com sucesso:', result);\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        result\n                    });\n                } catch (error) {\n                    console.error('Erro ao atualizar categoria:', error);\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: error instanceof Error ? error.message : 'Erro ao atualizar categoria'\n                    }, {\n                        status: 500\n                    });\n                }\n            case 'deleteCategory':\n                await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.deleteCategory)(body.id);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true\n                });\n            case 'createProduct':\n                console.log('API: Criando produto com dados:', body);\n                const newProduct = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.createProduct)(body);\n                console.log('API: Produto criado com sucesso:', newProduct);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(newProduct);\n            case 'updateProduct':\n                const { id: productId, ...productData } = body;\n                await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.updateProduct)(productId, productData);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true\n                });\n            case 'deleteProduct':\n                await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.deleteProduct)(body.id);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true\n                });\n            case 'createOrder':\n                // Log detalhado de categorias\n                if (body.items && Array.isArray(body.items)) {\n                    console.log('Categorias dos itens enviados para MongoDB:');\n                    body.items.forEach((item)=>{\n                        console.log(`- ${item.name}: categoria [${item.category || 'não definida'}]`);\n                    });\n                }\n                // Não modificamos os itens - usa exatamente o que foi enviado\n                const newOrder = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.createOrder)(body);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(newOrder);\n            case 'updateOrderStatus':\n                const { id, status, message } = body;\n                console.log('API: Atualizando status do pedido', {\n                    id,\n                    status,\n                    message\n                });\n                try {\n                    const updatedOrder = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.updateOrderStatus)(id, status, message);\n                    console.log('API: Status do pedido atualizado com sucesso', {\n                        id,\n                        status,\n                        updatedOrder\n                    });\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        order: updatedOrder\n                    });\n                } catch (error) {\n                    console.error('API: Erro ao atualizar status do pedido:', error);\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: 'Erro ao atualizar status do pedido',\n                        details: error instanceof Error ? error.message : String(error)\n                    }, {\n                        status: 500\n                    });\n                }\n            case 'getOrderStats':\n                {\n                    const { restaurantId, startDate, endDate } = body;\n                    // Validações\n                    if (!restaurantId || !startDate || !endDate) {\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                            error: 'restaurantId, startDate e endDate são obrigatórios'\n                        }, {\n                            status: 400\n                        });\n                    }\n                    try {\n                        // Logs para debug\n                        console.log('API getOrderStats - Datas recebidas:', {\n                            startDate,\n                            endDate,\n                            startDateObj: new Date(startDate),\n                            endDateObj: new Date(endDate)\n                        });\n                        // Busca as estatísticas\n                        const stats = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.getOrderStats)(restaurantId, new Date(startDate), new Date(endDate));\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(stats);\n                    } catch (error) {\n                        console.error('Erro ao buscar estatísticas:', error);\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                            error: 'Erro ao buscar estatísticas'\n                        }, {\n                            status: 500\n                        });\n                    }\n                }\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Ação inválida'\n                }, {\n                    status: 400\n                });\n        }\n    } catch (error) {\n        console.error('Erro na API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Erro interno do servidor'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function PUT(request) {\n    const searchParams = request.nextUrl.searchParams;\n    const action = searchParams.get('action');\n    const id = searchParams.get('id');\n    if (!id) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'id é obrigatório'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        const body = await request.json();\n        console.log('PUT request recebido:', {\n            action,\n            id,\n            body\n        });\n        switch(action){\n            case 'updateCategory':\n                try {\n                    console.log('Iniciando atualização de categoria:', {\n                        id,\n                        body\n                    });\n                    const result = await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.updateCategory)(id, body);\n                    console.log('Categoria atualizada com sucesso:', result);\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n                } catch (error) {\n                    console.error('Erro ao atualizar categoria na API:', error);\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        error: error instanceof Error ? error.message : 'Erro ao atualizar categoria',\n                        details: error\n                    }, {\n                        status: 500\n                    });\n                }\n            case 'updateProduct':\n                await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.updateProduct)(id, body);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true\n                });\n            case 'updateOrderStatus':\n                const { status, message } = body;\n                await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.updateOrderStatus)(id, status, message);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true\n                });\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Ação inválida'\n                }, {\n                    status: 400\n                });\n        }\n    } catch (error) {\n        console.error('Erro geral na API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Erro interno do servidor',\n            details: error instanceof Error ? error.message : String(error)\n        }, {\n            status: 500\n        });\n    }\n}\nasync function DELETE(request) {\n    const searchParams = request.nextUrl.searchParams;\n    const action = searchParams.get('action');\n    const id = searchParams.get('id');\n    if (!id) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'id é obrigatório'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        switch(action){\n            case 'deleteCategory':\n                await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.deleteCategory)(id);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true\n                });\n            case 'deleteProduct':\n                await (0,_lib_mongodb_services__WEBPACK_IMPORTED_MODULE_1__.deleteProduct)(id);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: true\n                });\n            default:\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Ação inválida'\n                }, {\n                    status: 400\n                });\n        }\n    } catch (error) {\n        console.error('Erro na API:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Erro interno do servidor'\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eUMsSUFBSSxDQUFDO1lBQUVULE9BQU87UUFBbUIsR0FBRztZQUFFVSxRQUFRO1FBQUk7SUFDeEU7SUFFQSxJQUFJO1FBQ0YsT0FBUXJCO1lBQ04sS0FBSztnQkFDSCxNQUFNaEIscUVBQWNBLENBQUMwQjtnQkFDckIsT0FBTy9CLHFEQUFZQSxDQUFDeUMsSUFBSSxDQUFDO29CQUFFeUMsU0FBUztnQkFBSztZQUUzQyxLQUFLO2dCQUNILE1BQU0xRSxvRUFBYUEsQ0FBQ3VCO2dCQUNwQixPQUFPL0IscURBQVlBLENBQUN5QyxJQUFJLENBQUM7b0JBQUV5QyxTQUFTO2dCQUFLO1lBRTNDO2dCQUNFLE9BQU9sRixxREFBWUEsQ0FBQ3lDLElBQUksQ0FBQztvQkFBRVQsT0FBTztnQkFBZ0IsR0FBRztvQkFBRVUsUUFBUTtnQkFBSTtRQUN2RTtJQUNGLEVBQUUsT0FBT1YsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsZ0JBQWdCQTtRQUM5QixPQUFPaEMscURBQVlBLENBQUN5QyxJQUFJLENBQUM7WUFBRVQsT0FBTztRQUEyQixHQUFHO1lBQUVVLFFBQVE7UUFBSTtJQUNoRjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvb3RhdmlvbWFyY28vRGVza3RvcC9Qcm9qZXRvcy9HbG9iYWwgTGl2ZS9rcmF0b2RlbGl2L2NhcmRhcGlvX2xhdGVzdC9zcmMvYXBwL2FwaS9tb25nb2RiL3JvdXRlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IFxuICBnZXRDYXRlZ29yaWVzLCBcbiAgZ2V0UHJvZHVjdHMsIFxuICBjcmVhdGVDYXRlZ29yeSwgXG4gIHVwZGF0ZUNhdGVnb3J5LCBcbiAgZGVsZXRlQ2F0ZWdvcnksXG4gIGNyZWF0ZVByb2R1Y3QsXG4gIHVwZGF0ZVByb2R1Y3QsXG4gIGRlbGV0ZVByb2R1Y3QsXG4gIGdldE9yZGVycyxcbiAgZ2V0T3JkZXIsXG4gIGNyZWF0ZU9yZGVyLFxuICB1cGRhdGVPcmRlclN0YXR1cyxcbiAgZ2V0T3JkZXJTdGF0cyxcbiAgZ2V0QmVzdFNlbGxpbmdQcm9kdWN0cyxcbiAgZ2V0RGFzaGJvYXJkU3RhdHNcbn0gZnJvbSAnQC9saWIvbW9uZ29kYi1zZXJ2aWNlcydcbmltcG9ydCB7IE9iamVjdElkIH0gZnJvbSAnbW9uZ29kYidcbmltcG9ydCBjbGllbnRQcm9taXNlIGZyb20gJ0AvbGliL21vbmdvZGInXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcmVxdWVzdC5uZXh0VXJsLnNlYXJjaFBhcmFtc1xuICBjb25zdCBhY3Rpb24gPSBzZWFyY2hQYXJhbXMuZ2V0KCdhY3Rpb24nKVxuXG4gIHRyeSB7XG4gICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgIGNhc2UgJ2dldENhdGVnb3JpZXMnOlxuICAgICAgICBjb25zdCByZXN0YXVyYW50SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdyZXN0YXVyYW50SWQnKVxuICAgICAgICBjb25zdCBjYXRlZ29yeUlkcyA9IHNlYXJjaFBhcmFtcy5nZXQoJ2lkcycpXG4gICAgICAgIFxuICAgICAgICBpZiAoY2F0ZWdvcnlJZHMpIHtcbiAgICAgICAgICAvLyBCdXNjYXIgY2F0ZWdvcmlhcyBlc3BlY8OtZmljYXMgcG9yIElEc1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBDb25lY3RhIGFvIE1vbmdvREJcbiAgICAgICAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IGNsaWVudFByb21pc2U7XG4gICAgICAgICAgICBjb25zdCBkYiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb252ZXJ0ZSBhIHN0cmluZyBkZSBJRHMgZW0gdW0gYXJyYXlcbiAgICAgICAgICAgIGNvbnN0IGlkQXJyYXkgPSBjYXRlZ29yeUlkcy5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb252ZXJ0ZSBvcyBJRHMgZW0gT2JqZWN0SWRzIHBhcmEgYSBjb25zdWx0YVxuICAgICAgICAgICAgY29uc3Qgb2JqZWN0SWRzID0gaWRBcnJheS5tYXAoaWQgPT4ge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT2JqZWN0SWQoaWQpO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYElEIGludsOhbGlkbzogJHtpZH1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuZmlsdGVyKGlkID0+IGlkICE9PSBudWxsKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQnVzY2EgYXMgY2F0ZWdvcmlhcyBwZWxvIElEXG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yaWVzID0gYXdhaXQgZGIuY29sbGVjdGlvbignY2F0ZWdvcmllcycpLmZpbmQoe1xuICAgICAgICAgICAgICBfaWQ6IHsgJGluOiBvYmplY3RJZHMgfVxuICAgICAgICAgICAgfSkudG9BcnJheSgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY2F0ZWdvcmllcyk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gYnVzY2FyIGNhdGVnb3JpYXMgcG9yIElEczonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0Vycm8gYW8gYnVzY2FyIGNhdGVnb3JpYXMnIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDYXNvIHRyYWRpY2lvbmFsOiBidXNjYXIgY2F0ZWdvcmlhcyBwb3IgcmVzdGF1cmFudGVcbiAgICAgICAgaWYgKCFyZXN0YXVyYW50SWQpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ3Jlc3RhdXJhbnRJZCDDqSBvYnJpZ2F0w7NyaW8nIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjYXRlZ29yaWVzID0gYXdhaXQgZ2V0Q2F0ZWdvcmllcyhyZXN0YXVyYW50SWQpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihjYXRlZ29yaWVzKVxuXG4gICAgICBjYXNlICdnZXRQcm9kdWN0cyc6XG4gICAgICAgIGNvbnN0IHJlc3RhdXJhbnRJZEZvclByb2R1Y3RzID0gc2VhcmNoUGFyYW1zLmdldCgncmVzdGF1cmFudElkJylcbiAgICAgICAgaWYgKCFyZXN0YXVyYW50SWRGb3JQcm9kdWN0cykge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAncmVzdGF1cmFudElkIMOpIG9icmlnYXTDs3JpbycgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgZ2V0UHJvZHVjdHMocmVzdGF1cmFudElkRm9yUHJvZHVjdHMpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihwcm9kdWN0cylcblxuICAgICAgY2FzZSAnZ2V0T3JkZXJzJzpcbiAgICAgICAgY29uc3QgcmVzdGF1cmFudElkRm9yT3JkZXJzID0gc2VhcmNoUGFyYW1zLmdldCgncmVzdGF1cmFudElkJylcbiAgICAgICAgaWYgKCFyZXN0YXVyYW50SWRGb3JPcmRlcnMpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ3Jlc3RhdXJhbnRJZCDDqSBvYnJpZ2F0w7NyaW8nIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygnQVBJOiBCdXNjYW5kbyBwZWRpZG9zIHBhcmEgcmVzdGF1cmFudElkOicsIHJlc3RhdXJhbnRJZEZvck9yZGVycylcbiAgICAgICAgY29uc3Qgb3JkZXJzID0gYXdhaXQgZ2V0T3JkZXJzKHJlc3RhdXJhbnRJZEZvck9yZGVycylcbiAgICAgICAgY29uc29sZS5sb2coYEFQSTogJHtvcmRlcnMubGVuZ3RofSBwZWRpZG9zIGVuY29udHJhZG9zYClcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKG9yZGVycylcblxuICAgICAgY2FzZSAnZ2V0T3JkZXInOlxuICAgICAgICBjb25zdCBvcmRlcklkID0gc2VhcmNoUGFyYW1zLmdldCgnaWQnKVxuICAgICAgICBpZiAoIW9yZGVySWQpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ2lkIMOpIG9icmlnYXTDs3JpbycgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBvcmRlciA9IGF3YWl0IGdldE9yZGVyKG9yZGVySWQpXG4gICAgICAgIFxuICAgICAgICAvLyBBZGljaW9uYSBjYXRlZ29yaWFzIGFvcyBpdGVucyBkbyBwZWRpZG8gcXVlIG7Do28gYXMgdMOqbVxuICAgICAgICBpZiAob3JkZXIgJiYgb3JkZXIuaXRlbXMgJiYgQXJyYXkuaXNBcnJheShvcmRlci5pdGVtcykpIHtcbiAgICAgICAgICAvLyBWZXJpZmljYSBxdWFpcyBpdGVucyBwcmVjaXNhbSBkZSBjYXRlZ29yaWFzXG4gICAgICAgICAgY29uc3QgaXRlbXNXaXRob3V0Q2F0ZWdvcnkgPSBvcmRlci5pdGVtcy5maWx0ZXIoaXRlbSA9PiAhaXRlbS5jYXRlZ29yeSk7XG4gICAgICAgICAgY29uc3QgaGFzVXBkYXRlcyA9IGl0ZW1zV2l0aG91dENhdGVnb3J5Lmxlbmd0aCA+IDA7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGhhc1VwZGF0ZXMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFbmNvbnRyYWRvcyAke2l0ZW1zV2l0aG91dENhdGVnb3J5Lmxlbmd0aH0gaXRlbnMgc2VtIGNhdGVnb3JpYSBubyBwZWRpZG8gJHtvcmRlcklkfWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBCdXNjYXIgcHJvZHV0b3MgcGFyYSBvYnRlciBjYXRlZ29yaWFzXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlO1xuICAgICAgICAgICAgICBjb25zdCBkYiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpO1xuICAgICAgICAgICAgICBjb25zdCBwcm9kdWN0c0NvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKCdwcm9kdWN0cycpO1xuICAgICAgICAgICAgICBjb25zdCBjYXRlZ29yaWVzQ29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oJ2NhdGVnb3JpZXMnKTtcbiAgICAgICAgICAgICAgY29uc3Qgb3JkZXJzQ29sbGVjdGlvbiA9IGRiLmNvbGxlY3Rpb24oJ29yZGVycycpO1xuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgbGV0IGhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBvcmRlci5pdGVtcykge1xuICAgICAgICAgICAgICAgIGlmICghaXRlbS5jYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEJ1c2NhbmRvIGNhdGVnb3JpYSBwYXJhIGl0ZW0gXCIke2l0ZW0ubmFtZX1cIiAoSUQ6ICR7aXRlbS5wcm9kdWN0SWR9KWApO1xuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAvLyBUZW50YSBlbmNvbnRyYXIgbyBwcm9kdXRvIHBlbG8gSURcbiAgICAgICAgICAgICAgICAgIGxldCBwcm9kdWN0O1xuICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcHJvZHVjdCA9IGF3YWl0IHByb2R1Y3RzQ29sbGVjdGlvbi5maW5kT25lKHtcbiAgICAgICAgICAgICAgICAgICAgICAkb3I6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIHsgX2lkOiBuZXcgT2JqZWN0SWQoaXRlbS5wcm9kdWN0SWQpIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB7IGlkOiBpdGVtLnByb2R1Y3RJZCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgeyBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkIH1cbiAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRW5jb250cmFkbyBwcm9kdXRvIHBhcmEgaXRlbSAnJHtpdGVtLm5hbWV9JzogJHtwcm9kdWN0Lm5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gQnVzY2EgcG9yIG5vbWUgc2UgbsOjbyBlbmNvbnRyYXIgcG9yIElEXG4gICAgICAgICAgICAgICAgICAgICAgcHJvZHVjdCA9IGF3YWl0IHByb2R1Y3RzQ29sbGVjdGlvbi5maW5kT25lKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZVxuICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9kdWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRW5jb250cmFkbyBwcm9kdXRvIHBlbG8gbm9tZTogJHtwcm9kdWN0Lm5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBFcnJvIGFvIGJ1c2NhciBwcm9kdXRvIHBlbG8gSUQgJHtpdGVtLnByb2R1Y3RJZH1gLCBlKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgaWYgKHByb2R1Y3QpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNhdGVnb3J5TmFtZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBUZW50YSBvYnRlciBhIGNhdGVnb3JpYSBkZSB2w6FyaWFzIGZvbnRlc1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvZHVjdC5jYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIFNlIG8gcHJvZHV0byBqw6EgdGVtIGEgY2F0ZWdvcmlhIGRpcmV0YW1lbnRlXG4gICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnlOYW1lID0gcHJvZHVjdC5jYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgQ2F0ZWdvcmlhIGRvIHByb2R1dG86ICR7Y2F0ZWdvcnlOYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByb2R1Y3QuY2F0ZWdvcnlJZCkge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIFNlIG8gcHJvZHV0byB0ZW0gdW0gY2F0ZWdvcnlJZCwgYnVzY2EgYSBjYXRlZ29yaWFcbiAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2F0ZWdvcnkgPSBhd2FpdCBjYXRlZ29yaWVzQ29sbGVjdGlvbi5maW5kT25lKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgJG9yOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IG5ldyBPYmplY3RJZChwcm9kdWN0LmNhdGVnb3J5SWQpIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBpZDogcHJvZHVjdC5jYXRlZ29yeUlkIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYXRlZ29yeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWUgPSBjYXRlZ29yeS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgQ2F0ZWdvcmlhIGVuY29udHJhZGEgcGVsbyBJRDogJHtjYXRlZ29yeU5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm8gYW8gYnVzY2FyIGNhdGVnb3JpYSBwZWxvIElEICR7cHJvZHVjdC5jYXRlZ29yeUlkfWAsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwcm9kdWN0LmNhdGVnb3J5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgIC8vIEFsZ3VucyBwcm9kdXRvcyBwb2RlbSB0ZXIgY2F0ZWdvcnlOYW1lIGRpcmV0b1xuICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5TmFtZSA9IHByb2R1Y3QuY2F0ZWdvcnlOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVc2FuZG8gY2F0ZWdvcnlOYW1lIGRvIHByb2R1dG86ICR7Y2F0ZWdvcnlOYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoY2F0ZWdvcnlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gQXR1YWxpemEgbyBpdGVtIGVtIG1lbcOzcmlhXG4gICAgICAgICAgICAgICAgICAgICAgaXRlbS5jYXRlZ29yeSA9IGNhdGVnb3J5TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICBoYXNDaGFuZ2VzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAvLyBBdHVhbGl6YSBubyBiYW5jbyBkZSBkYWRvcyB0YW1iw6ltXG4gICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVJlc3VsdCA9IGF3YWl0IG9yZGVyc0NvbGxlY3Rpb24udXBkYXRlT25lKFxuICAgICAgICAgICAgICAgICAgICAgICAgICB7IF9pZDogbmV3IE9iamVjdElkKG9yZGVySWQpLCBcIml0ZW1zLnByb2R1Y3RJZFwiOiBpdGVtLnByb2R1Y3RJZCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICB7ICRzZXQ6IHsgXCJpdGVtcy4kLmNhdGVnb3J5XCI6IGNhdGVnb3J5TmFtZSB9IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBdHVhbGl6YcOnw6NvIG5vIGJhbmNvOiAke3VwZGF0ZVJlc3VsdC5tb2RpZmllZENvdW50fSBpdGVtKHMpIG1vZGlmaWNhZG8ocylgKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh1cGRhdGVFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm8gYW8gYXR1YWxpemFyIGNhdGVnb3JpYSBubyBiYW5jbzpcIiwgdXBkYXRlRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgTsOjbyBmb2kgcG9zc8OtdmVsIGRldGVybWluYXIgYSBjYXRlZ29yaWEgcGFyYSBvIGl0ZW0gJyR7aXRlbS5uYW1lfSdgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFByb2R1dG8gbsOjbyBlbmNvbnRyYWRvIHBhcmEgaXRlbSAnJHtpdGVtLm5hbWV9J2ApO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgaWYgKGhhc0NoYW5nZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhdGVnb3JpYXMgYXR1YWxpemFkYXMgY29tIHN1Y2Vzc28gcGFyYSBvIHBlZGlkbzpcIiwgb3JkZXJJZCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gZW5yaXF1ZWNlciBwZWRpZG8gY29tIGNhdGVnb3JpYXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKG9yZGVyKVxuXG4gICAgICBjYXNlICdnZXREYXNoYm9hcmRTdGF0cyc6IHtcbiAgICAgICAgY29uc3QgcmVzdGF1cmFudElkRm9yU3RhdHMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdyZXN0YXVyYW50SWQnKVxuICAgICAgICBpZiAoIXJlc3RhdXJhbnRJZEZvclN0YXRzKSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdyZXN0YXVyYW50SWQgw6kgb2JyaWdhdMOzcmlvJyB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgZ2V0RGFzaGJvYXJkU3RhdHMocmVzdGF1cmFudElkRm9yU3RhdHMpXG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHN0YXRzKVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gYnVzY2FyIGVzdGF0w61zdGljYXMgZG8gZGFzaGJvYXJkOicsIGVycm9yKVxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgIHsgZXJyb3I6ICdFcnJvIGFvIGJ1c2NhciBlc3RhdMOtc3RpY2FzIGRvIGRhc2hib2FyZCcgfSxcbiAgICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0HDp8OjbyBpbnbDoWxpZGEnIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJybyBuYSBBUEk6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdFcnJvIGludGVybm8gZG8gc2Vydmlkb3InIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCBzZWFyY2hQYXJhbXMgPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoUGFyYW1zXG4gIGNvbnN0IGFjdGlvbiA9IHNlYXJjaFBhcmFtcy5nZXQoJ2FjdGlvbicpXG5cbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcblxuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlICdjcmVhdGVDYXRlZ29yeSc6XG4gICAgICAgIGNvbnN0IG5ld0NhdGVnb3J5ID0gYXdhaXQgY3JlYXRlQ2F0ZWdvcnkoYm9keSlcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKG5ld0NhdGVnb3J5KVxuXG4gICAgICBjYXNlICd1cGRhdGVDYXRlZ29yeSc6XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeyBpZDogY2F0ZWdvcnlJZCwgLi4uY2F0ZWdvcnlEYXRhIH0gPSBib2R5XG4gICAgICAgICAgY29uc29sZS5sb2coJ0F0dWFsaXphbmRvIGNhdGVnb3JpYSBuYSBBUEk6JywgeyBjYXRlZ29yeUlkLCBjYXRlZ29yeURhdGEgfSlcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoIWNhdGVnb3J5SWQpIHtcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgICAgeyBlcnJvcjogJ0lEIGRhIGNhdGVnb3JpYSDDqSBvYnJpZ2F0w7NyaW8nIH0sXG4gICAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwZGF0ZUNhdGVnb3J5KGNhdGVnb3J5SWQsIGNhdGVnb3J5RGF0YSlcbiAgICAgICAgICBjb25zb2xlLmxvZygnQ2F0ZWdvcmlhIGF0dWFsaXphZGEgY29tIHN1Y2Vzc286JywgcmVzdWx0KVxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIHJlc3VsdCB9KVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gYXR1YWxpemFyIGNhdGVnb3JpYTonLCBlcnJvcilcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICB7IGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdFcnJvIGFvIGF0dWFsaXphciBjYXRlZ29yaWEnIH0sXG4gICAgICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICAgICApXG4gICAgICAgIH1cblxuICAgICAgY2FzZSAnZGVsZXRlQ2F0ZWdvcnknOlxuICAgICAgICBhd2FpdCBkZWxldGVDYXRlZ29yeShib2R5LmlkKVxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pXG5cbiAgICAgIGNhc2UgJ2NyZWF0ZVByb2R1Y3QnOlxuICAgICAgICBjb25zb2xlLmxvZygnQVBJOiBDcmlhbmRvIHByb2R1dG8gY29tIGRhZG9zOicsIGJvZHkpXG4gICAgICAgIGNvbnN0IG5ld1Byb2R1Y3QgPSBhd2FpdCBjcmVhdGVQcm9kdWN0KGJvZHkpXG4gICAgICAgIGNvbnNvbGUubG9nKCdBUEk6IFByb2R1dG8gY3JpYWRvIGNvbSBzdWNlc3NvOicsIG5ld1Byb2R1Y3QpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihuZXdQcm9kdWN0KVxuXG4gICAgICBjYXNlICd1cGRhdGVQcm9kdWN0JzpcbiAgICAgICAgY29uc3QgeyBpZDogcHJvZHVjdElkLCAuLi5wcm9kdWN0RGF0YSB9ID0gYm9keVxuICAgICAgICBhd2FpdCB1cGRhdGVQcm9kdWN0KHByb2R1Y3RJZCwgcHJvZHVjdERhdGEpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcblxuICAgICAgY2FzZSAnZGVsZXRlUHJvZHVjdCc6XG4gICAgICAgIGF3YWl0IGRlbGV0ZVByb2R1Y3QoYm9keS5pZClcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxuXG4gICAgICBjYXNlICdjcmVhdGVPcmRlcic6XG4gICAgICAgIC8vIExvZyBkZXRhbGhhZG8gZGUgY2F0ZWdvcmlhc1xuICAgICAgICBpZiAoYm9keS5pdGVtcyAmJiBBcnJheS5pc0FycmF5KGJvZHkuaXRlbXMpKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0NhdGVnb3JpYXMgZG9zIGl0ZW5zIGVudmlhZG9zIHBhcmEgTW9uZ29EQjonKTsgXG4gICAgICAgICAgYm9keS5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYC0gJHtpdGVtLm5hbWV9OiBjYXRlZ29yaWEgWyR7aXRlbS5jYXRlZ29yeSB8fCAnbsOjbyBkZWZpbmlkYSd9XWApO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBOw6NvIG1vZGlmaWNhbW9zIG9zIGl0ZW5zIC0gdXNhIGV4YXRhbWVudGUgbyBxdWUgZm9pIGVudmlhZG9cbiAgICAgICAgY29uc3QgbmV3T3JkZXIgPSBhd2FpdCBjcmVhdGVPcmRlcihib2R5KVxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24obmV3T3JkZXIpXG5cbiAgICAgIGNhc2UgJ3VwZGF0ZU9yZGVyU3RhdHVzJzpcbiAgICAgICAgY29uc3QgeyBpZCwgc3RhdHVzLCBtZXNzYWdlIH0gPSBib2R5XG4gICAgICAgIGNvbnNvbGUubG9nKCdBUEk6IEF0dWFsaXphbmRvIHN0YXR1cyBkbyBwZWRpZG8nLCB7XG4gICAgICAgICAgaWQsXG4gICAgICAgICAgc3RhdHVzLFxuICAgICAgICAgIG1lc3NhZ2VcbiAgICAgICAgfSlcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB1cGRhdGVkT3JkZXIgPSBhd2FpdCB1cGRhdGVPcmRlclN0YXR1cyhpZCwgc3RhdHVzLCBtZXNzYWdlKVxuICAgICAgICAgIGNvbnNvbGUubG9nKCdBUEk6IFN0YXR1cyBkbyBwZWRpZG8gYXR1YWxpemFkbyBjb20gc3VjZXNzbycsIHtcbiAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgc3RhdHVzLFxuICAgICAgICAgICAgdXBkYXRlZE9yZGVyXG4gICAgICAgICAgfSlcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBvcmRlcjogdXBkYXRlZE9yZGVyIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignQVBJOiBFcnJvIGFvIGF0dWFsaXphciBzdGF0dXMgZG8gcGVkaWRvOicsIGVycm9yKVxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgIHsgZXJyb3I6ICdFcnJvIGFvIGF0dWFsaXphciBzdGF0dXMgZG8gcGVkaWRvJywgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpIH0sXG4gICAgICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICAgICApXG4gICAgICAgIH1cblxuICAgICAgY2FzZSAnZ2V0T3JkZXJTdGF0cyc6IHtcbiAgICAgICAgY29uc3QgeyByZXN0YXVyYW50SWQsIHN0YXJ0RGF0ZSwgZW5kRGF0ZSB9ID0gYm9keVxuICAgICAgICBcbiAgICAgICAgLy8gVmFsaWRhw6fDtWVzXG4gICAgICAgIGlmICghcmVzdGF1cmFudElkIHx8ICFzdGFydERhdGUgfHwgIWVuZERhdGUpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICB7IGVycm9yOiAncmVzdGF1cmFudElkLCBzdGFydERhdGUgZSBlbmREYXRlIHPDo28gb2JyaWdhdMOzcmlvcycgfSxcbiAgICAgICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgICAgIClcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gTG9ncyBwYXJhIGRlYnVnXG4gICAgICAgICAgY29uc29sZS5sb2coJ0FQSSBnZXRPcmRlclN0YXRzIC0gRGF0YXMgcmVjZWJpZGFzOicsIHtcbiAgICAgICAgICAgIHN0YXJ0RGF0ZSxcbiAgICAgICAgICAgIGVuZERhdGUsXG4gICAgICAgICAgICBzdGFydERhdGVPYmo6IG5ldyBEYXRlKHN0YXJ0RGF0ZSksXG4gICAgICAgICAgICBlbmREYXRlT2JqOiBuZXcgRGF0ZShlbmREYXRlKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQnVzY2EgYXMgZXN0YXTDrXN0aWNhc1xuICAgICAgICAgIGNvbnN0IHN0YXRzID0gYXdhaXQgZ2V0T3JkZXJTdGF0cyhcbiAgICAgICAgICAgIHJlc3RhdXJhbnRJZCxcbiAgICAgICAgICAgIG5ldyBEYXRlKHN0YXJ0RGF0ZSksXG4gICAgICAgICAgICBuZXcgRGF0ZShlbmREYXRlKVxuICAgICAgICAgIClcblxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihzdGF0cylcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGJ1c2NhciBlc3RhdMOtc3RpY2FzOicsIGVycm9yKVxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgICAgIHsgZXJyb3I6ICdFcnJvIGFvIGJ1c2NhciBlc3RhdMOtc3RpY2FzJyB9LFxuICAgICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQcOnw6NvIGludsOhbGlkYScgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvIG5hIEFQSTonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0Vycm8gaW50ZXJubyBkbyBzZXJ2aWRvcicgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQVVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcmVxdWVzdC5uZXh0VXJsLnNlYXJjaFBhcmFtc1xuICBjb25zdCBhY3Rpb24gPSBzZWFyY2hQYXJhbXMuZ2V0KCdhY3Rpb24nKVxuICBjb25zdCBpZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2lkJylcblxuICBpZiAoIWlkKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdpZCDDqSBvYnJpZ2F0w7NyaW8nIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc29sZS5sb2coJ1BVVCByZXF1ZXN0IHJlY2ViaWRvOicsIHsgYWN0aW9uLCBpZCwgYm9keSB9KVxuXG4gICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgIGNhc2UgJ3VwZGF0ZUNhdGVnb3J5JzpcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnSW5pY2lhbmRvIGF0dWFsaXphw6fDo28gZGUgY2F0ZWdvcmlhOicsIHsgaWQsIGJvZHkgfSlcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cGRhdGVDYXRlZ29yeShpZCwgYm9keSlcbiAgICAgICAgICBjb25zb2xlLmxvZygnQ2F0ZWdvcmlhIGF0dWFsaXphZGEgY29tIHN1Y2Vzc286JywgcmVzdWx0KVxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXN1bHQpXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyBhdHVhbGl6YXIgY2F0ZWdvcmlhIG5hIEFQSTonLCBlcnJvcilcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgICAgICB7IFxuICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRXJybyBhbyBhdHVhbGl6YXIgY2F0ZWdvcmlhJyxcbiAgICAgICAgICAgICAgZGV0YWlsczogZXJyb3JcbiAgICAgICAgICAgIH0sIFxuICAgICAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICAgICAgKVxuICAgICAgICB9XG5cbiAgICAgIGNhc2UgJ3VwZGF0ZVByb2R1Y3QnOlxuICAgICAgICBhd2FpdCB1cGRhdGVQcm9kdWN0KGlkLCBib2R5KVxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pXG5cbiAgICAgIGNhc2UgJ3VwZGF0ZU9yZGVyU3RhdHVzJzpcbiAgICAgICAgY29uc3QgeyBzdGF0dXMsIG1lc3NhZ2UgfSA9IGJvZHlcbiAgICAgICAgYXdhaXQgdXBkYXRlT3JkZXJTdGF0dXMoaWQsIHN0YXR1cywgbWVzc2FnZSlcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0HDp8OjbyBpbnbDoWxpZGEnIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJybyBnZXJhbCBuYSBBUEk6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBcbiAgICAgICAgZXJyb3I6ICdFcnJvIGludGVybm8gZG8gc2Vydmlkb3InLFxuICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcilcbiAgICAgIH0sIFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcmVxdWVzdC5uZXh0VXJsLnNlYXJjaFBhcmFtc1xuICBjb25zdCBhY3Rpb24gPSBzZWFyY2hQYXJhbXMuZ2V0KCdhY3Rpb24nKVxuICBjb25zdCBpZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2lkJylcblxuICBpZiAoIWlkKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdpZCDDqSBvYnJpZ2F0w7NyaW8nIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgfVxuXG4gIHRyeSB7XG4gICAgc3dpdGNoIChhY3Rpb24pIHtcbiAgICAgIGNhc2UgJ2RlbGV0ZUNhdGVnb3J5JzpcbiAgICAgICAgYXdhaXQgZGVsZXRlQ2F0ZWdvcnkoaWQpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcblxuICAgICAgY2FzZSAnZGVsZXRlUHJvZHVjdCc6XG4gICAgICAgIGF3YWl0IGRlbGV0ZVByb2R1Y3QoaWQpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdBw6fDo28gaW52w6FsaWRhJyB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gbmEgQVBJOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRXJybyBpbnRlcm5vIGRvIHNlcnZpZG9yJyB9LCB7IHN0YXR1czogNTAwIH0pXG4gIH1cbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdldENhdGVnb3JpZXMiLCJnZXRQcm9kdWN0cyIsImNyZWF0ZUNhdGVnb3J5IiwidXBkYXRlQ2F0ZWdvcnkiLCJkZWxldGVDYXRlZ29yeSIsImNyZWF0ZVByb2R1Y3QiLCJ1cGRhdGVQcm9kdWN0IiwiZGVsZXRlUHJvZHVjdCIsImdldE9yZGVycyIsImdldE9yZGVyIiwiY3JlYXRlT3JkZXIiLCJ1cGRhdGVPcmRlclN0YXR1cyIsImdldE9yZGVyU3RhdHMiLCJnZXREYXNoYm9hcmRTdGF0cyIsIk9iamVjdElkIiwiY2xpZW50UHJvbWlzZSIsIkdFVCIsInJlcXVlc3QiLCJzZWFyY2hQYXJhbXMiLCJuZXh0VXJsIiwiYWN0aW9uIiwiZ2V0IiwicmVzdGF1cmFudElkIiwiY2F0ZWdvcnlJZHMiLCJjbGllbnQiLCJkYiIsImlkQXJyYXkiLCJzcGxpdCIsIm9iamVjdElkcyIsIm1hcCIsImlkIiwiZXJyb3IiLCJjb25zb2xlIiwiZmlsdGVyIiwiY2F0ZWdvcmllcyIsImNvbGxlY3Rpb24iLCJmaW5kIiwiX2lkIiwiJGluIiwidG9BcnJheSIsImpzb24iLCJzdGF0dXMiLCJyZXN0YXVyYW50SWRGb3JQcm9kdWN0cyIsInByb2R1Y3RzIiwicmVzdGF1cmFudElkRm9yT3JkZXJzIiwibG9nIiwib3JkZXJzIiwibGVuZ3RoIiwib3JkZXJJZCIsIm9yZGVyIiwiaXRlbXMiLCJBcnJheSIsImlzQXJyYXkiLCJpdGVtc1dpdGhvdXRDYXRlZ29yeSIsIml0ZW0iLCJjYXRlZ29yeSIsImhhc1VwZGF0ZXMiLCJwcm9kdWN0c0NvbGxlY3Rpb24iLCJjYXRlZ29yaWVzQ29sbGVjdGlvbiIsIm9yZGVyc0NvbGxlY3Rpb24iLCJoYXNDaGFuZ2VzIiwibmFtZSIsInByb2R1Y3RJZCIsInByb2R1Y3QiLCJmaW5kT25lIiwiJG9yIiwiZSIsImNhdGVnb3J5TmFtZSIsImNhdGVnb3J5SWQiLCJ1cGRhdGVSZXN1bHQiLCJ1cGRhdGVPbmUiLCIkc2V0IiwibW9kaWZpZWRDb3VudCIsInVwZGF0ZUVycm9yIiwicmVzdGF1cmFudElkRm9yU3RhdHMiLCJzdGF0cyIsIlBPU1QiLCJib2R5IiwibmV3Q2F0ZWdvcnkiLCJjYXRlZ29yeURhdGEiLCJyZXN1bHQiLCJzdWNjZXNzIiwiRXJyb3IiLCJtZXNzYWdlIiwibmV3UHJvZHVjdCIsInByb2R1Y3REYXRhIiwiZm9yRWFjaCIsIm5ld09yZGVyIiwidXBkYXRlZE9yZGVyIiwiZGV0YWlscyIsIlN0cmluZyIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJzdGFydERhdGVPYmoiLCJEYXRlIiwiZW5kRGF0ZU9iaiIsIlBVVCIsIkRFTEVURSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/mongodb/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/mongodb-services.ts":
/*!*************************************!*\
  !*** ./src/lib/mongodb-services.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createCategory: () => (/* binding */ createCategory),\n/* harmony export */   createOrder: () => (/* binding */ createOrder),\n/* harmony export */   createProduct: () => (/* binding */ createProduct),\n/* harmony export */   deleteCategory: () => (/* binding */ deleteCategory),\n/* harmony export */   deleteProduct: () => (/* binding */ deleteProduct),\n/* harmony export */   getBestSellingProducts: () => (/* binding */ getBestSellingProducts),\n/* harmony export */   getCategories: () => (/* binding */ getCategories),\n/* harmony export */   getDashboardStats: () => (/* binding */ getDashboardStats),\n/* harmony export */   getOrder: () => (/* binding */ getOrder),\n/* harmony export */   getOrderStats: () => (/* binding */ getOrderStats),\n/* harmony export */   getOrders: () => (/* binding */ getOrders),\n/* harmony export */   getProducts: () => (/* binding */ getProducts),\n/* harmony export */   getProductsByCategory: () => (/* binding */ getProductsByCategory),\n/* harmony export */   updateCategory: () => (/* binding */ updateCategory),\n/* harmony export */   updateOrderStatus: () => (/* binding */ updateOrderStatus),\n/* harmony export */   updateProduct: () => (/* binding */ updateProduct)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mongodb */ \"(rsc)/./src/lib/mongodb.ts\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _socket__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./socket */ \"(rsc)/./src/lib/socket.ts\");\n\n\n\n\n\n// Funções para Categorias\nasync function getCategories(restaurantId) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('categories');\n    console.log('Buscando categorias para restaurantId:', restaurantId);\n    const categories = await collection.find({\n        restaurantId\n    }).sort({\n        order: 1\n    }).toArray();\n    // Normaliza os IDs antes de retornar\n    const normalizedCategories = categories.map((category)=>({\n            ...category,\n            id: category._id.toString()\n        }));\n    console.log('Categorias encontradas:', normalizedCategories);\n    return normalizedCategories;\n}\nasync function createCategory(category) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('categories');\n    console.log('Criando categoria com dados:', category);\n    // Garante que o restaurantId está presente\n    if (!category.restaurantId) {\n        throw new Error('restaurantId é obrigatório para criar uma categoria');\n    }\n    const result = await collection.insertOne(category);\n    const createdCategory = {\n        ...category,\n        id: result.insertedId.toString(),\n        _id: result.insertedId\n    };\n    console.log('Categoria criada com sucesso:', createdCategory);\n    return createdCategory;\n}\nasync function updateCategory(id, category) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('categories');\n    console.log('Iniciando atualização da categoria no MongoDB:', {\n        id,\n        category\n    });\n    try {\n        // Remove campos que não devem ser atualizados\n        const { _id, id: categoryId, ...updateData } = category;\n        // Primeiro busca a categoria existente\n        const existingCategory = await collection.findOne({\n            _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(id)\n        });\n        console.log('Categoria existente:', existingCategory);\n        if (!existingCategory) {\n            console.error('Categoria não encontrada:', id);\n            throw new Error('Categoria não encontrada');\n        }\n        // Mantém o restaurantId original\n        const restaurantId = existingCategory.restaurantId;\n        // Verifica se o restaurantId da requisição corresponde ao da categoria\n        if (category.restaurantId && category.restaurantId !== restaurantId) {\n            console.error('Tentativa de edição não autorizada:', {\n                categoriaRestaurantId: restaurantId,\n                requestRestaurantId: category.restaurantId\n            });\n            throw new Error('Não autorizado a editar esta categoria');\n        }\n        // Prepara os dados para atualização\n        const updateDoc = {\n            $set: {\n                name: updateData.name || existingCategory.name,\n                description: updateData.description || existingCategory.description,\n                order: updateData.order ?? existingCategory.order,\n                restaurantId,\n                updatedAt: new Date()\n            }\n        };\n        console.log('Dados para atualização:', updateDoc);\n        // Faz a atualização\n        const result = await collection.findOneAndUpdate({\n            _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(id)\n        }, updateDoc, {\n            returnDocument: 'after'\n        });\n        console.log('Resultado da atualização:', result);\n        // Na versão mais recente do MongoDB, o resultado vem diretamente no objeto\n        const updatedDoc = result;\n        if (!updatedDoc) {\n            console.error('Falha na atualização - documento não encontrado:', {\n                id,\n                result\n            });\n            throw new Error('Categoria não encontrada ou não pôde ser atualizada');\n        }\n        // Formata o resultado para retornar\n        const updatedCategory = {\n            ...updatedDoc,\n            id: updatedDoc._id.toString()\n        };\n        // Remove campos que não devem ser retornados\n        delete updatedCategory._id;\n        console.log('Categoria atualizada com sucesso:', updatedCategory);\n        return updatedCategory;\n    } catch (error) {\n        console.error('Erro ao atualizar categoria no MongoDB:', error);\n        throw error;\n    }\n}\nasync function deleteCategory(id) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const db = client.db('cardapio_digital');\n    // Primeiro encontra todos os produtos da categoria\n    const products = await db.collection('products').find({\n        categoryId: id\n    }).toArray();\n    // Deleta as imagens do Supabase Storage\n    for (const product of products){\n        if (product.image) {\n            try {\n                const imageUrl = new URL(product.image);\n                const imagePath = imageUrl.pathname.split('/public/')[1];\n                if (imagePath) {\n                    // Deleta a imagem do storage\n                    await _lib_supabase__WEBPACK_IMPORTED_MODULE_2__.supabase.storage.from('restaurant-images').remove([\n                        imagePath\n                    ]);\n                }\n            } catch (error) {\n                console.error('Erro ao deletar imagem do produto:', error);\n            }\n        }\n    }\n    // Deleta todos os produtos da categoria\n    await db.collection('products').deleteMany({\n        categoryId: id\n    });\n    // Por fim, deleta a categoria\n    await db.collection('categories').deleteOne({\n        _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(id)\n    });\n}\n// Funções para Produtos\nasync function getProducts(restaurantId) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('products');\n    console.log('Buscando produtos para restaurantId:', restaurantId);\n    const products = await collection.find({\n        restaurantId\n    }).toArray();\n    // Normaliza os dados antes de retornar\n    const normalizedProducts = products.map((product)=>({\n            ...product,\n            id: product._id.toString(),\n            image: product.image || product.imageUrl,\n            imageUrl: undefined // Remove campo duplicado\n        }));\n    console.log('Produtos encontrados:', normalizedProducts);\n    return normalizedProducts;\n}\nasync function getProductsByCategory(restaurantId, categoryId) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('products');\n    return collection.find({\n        restaurantId,\n        categoryId\n    }).toArray();\n}\nasync function createProduct(product) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('products');\n    // Normaliza os campos da imagem e garante todos os campos obrigatórios\n    const normalizedProduct = {\n        ...product,\n        image: product.imageUrl || product.image,\n        imageUrl: undefined,\n        available: product.available ?? true,\n        featured: product.featured ?? false,\n        additions: product.additions || [],\n        isPizza: product.isPizza ?? false,\n        allowHalfHalf: product.allowHalfHalf ?? false,\n        createdAt: new Date()\n    };\n    console.log('Salvando produto no MongoDB:', normalizedProduct);\n    const result = await collection.insertOne(normalizedProduct);\n    const createdProduct = {\n        ...normalizedProduct,\n        id: result.insertedId.toString(),\n        _id: undefined // Remove o _id da resposta\n    };\n    console.log('Produto salvo:', createdProduct);\n    return createdProduct;\n}\nasync function updateProduct(id, product) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('products');\n    console.log('Iniciando atualização do produto:', {\n        id,\n        product\n    });\n    try {\n        // Remove campos que não devem ser atualizados\n        const { _id, id: productId, ...updateData } = product;\n        // Primeiro busca o produto existente\n        const existingProduct = await collection.findOne({\n            _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(id)\n        });\n        console.log('Produto existente:', existingProduct);\n        if (!existingProduct) {\n            console.error('Produto não encontrado:', id);\n            throw new Error('Produto não encontrado');\n        }\n        // Mantém o restaurantId original\n        const restaurantId = existingProduct.restaurantId;\n        // Verifica se o restaurantId da requisição corresponde ao do produto\n        if (product.restaurantId && product.restaurantId !== restaurantId) {\n            console.error('Tentativa de edição não autorizada:', {\n                produtoRestaurantId: restaurantId,\n                requestRestaurantId: product.restaurantId\n            });\n            throw new Error('Não autorizado a editar este produto');\n        }\n        // Prepara os dados para atualização\n        const updateDoc = {\n            $set: {\n                name: updateData.name || existingProduct.name,\n                description: updateData.description || existingProduct.description,\n                price: updateData.price ?? existingProduct.price,\n                categoryId: updateData.categoryId || existingProduct.categoryId,\n                available: updateData.available ?? existingProduct.available,\n                featured: updateData.featured ?? existingProduct.featured,\n                additions: updateData.additions || existingProduct.additions,\n                image: updateData.image ?? existingProduct.image,\n                isPizza: updateData.isPizza ?? existingProduct.isPizza ?? false,\n                allowHalfHalf: updateData.allowHalfHalf ?? existingProduct.allowHalfHalf ?? false,\n                restaurantId,\n                updatedAt: new Date()\n            }\n        };\n        console.log('Dados para atualização:', updateDoc);\n        // Faz a atualização\n        const result = await collection.findOneAndUpdate({\n            _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(id)\n        }, updateDoc, {\n            returnDocument: 'after'\n        });\n        console.log('Resultado da atualização:', result);\n        if (!result) {\n            console.error('Falha na atualização - produto não encontrado:', {\n                id,\n                result\n            });\n            throw new Error('Produto não encontrado ou não pôde ser atualizado');\n        }\n        // Formata o resultado para retornar\n        const updatedProduct = {\n            ...result,\n            id: result._id.toString()\n        };\n        // Remove campos que não devem ser retornados\n        delete updatedProduct._id;\n        console.log('Produto atualizado com sucesso:', updatedProduct);\n        return updatedProduct;\n    } catch (error) {\n        console.error('Erro ao atualizar produto:', error);\n        throw error;\n    }\n}\nasync function deleteProduct(id) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('products');\n    await collection.deleteOne({\n        _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(id)\n    });\n}\n// Funções para Pedidos\nasync function getOrders(restaurantId) {\n    try {\n        const { db } = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.connectToDatabase)();\n        const orders = await db.collection('orders').find({\n            restaurantId\n        }).sort({\n            createdAt: -1\n        }).toArray();\n        return orders;\n    } catch (error) {\n        console.error('Erro ao buscar pedidos:', error);\n        throw new Error('Erro ao buscar pedidos');\n    }\n}\nasync function getOrder(id) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('orders');\n    console.log('Buscando pedido com ID:', id);\n    try {\n        const order = await collection.findOne({\n            _id: new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(id)\n        });\n        if (!order) {\n            console.log('Pedido não encontrado:', id);\n            return null;\n        }\n        // Debug para verificar a presença do campo categoria nos itens\n        if (order.items && Array.isArray(order.items)) {\n            console.log('Depuração de itens do pedido no MongoDB:');\n            order.items.forEach((item, index)=>{\n                console.log(`MongoDB - Item ${index + 1}: ${item.name}`);\n                console.log('Campos disponíveis:', Object.keys(item));\n                console.log('Categoria do item:', item.category || 'NÃO ENCONTRADA');\n            });\n        }\n        // Normaliza o ID antes de retornar\n        const normalizedOrder = {\n            ...order,\n            id: order._id.toString(),\n            _id: order._id.toString() // Mantém _id como string para compatibilidade\n        };\n        console.log('Pedido encontrado:', normalizedOrder);\n        return normalizedOrder;\n    } catch (error) {\n        console.error('Erro ao buscar pedido:', error);\n        throw error;\n    }\n}\nasync function createOrder(order) {\n    try {\n        const { db } = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.connectToDatabase)();\n        // Adiciona data de criação e garante que orderType esteja definido\n        const orderWithTimestamp = {\n            ...order,\n            // Garante que orderType esteja definido (compatibilidade com deliveryMethod)\n            orderType: order.orderType || order.deliveryMethod || 'delivery',\n            createdAt: new Date().toISOString(),\n            updatedAt: new Date().toISOString()\n        };\n        const result = await db.collection('orders').insertOne(orderWithTimestamp);\n        // Recupera o pedido completo com o ID gerado\n        const createdOrder = {\n            ...orderWithTimestamp,\n            _id: result.insertedId.toString()\n        };\n        // Emite evento via Socket.IO para notificar sobre o novo pedido\n        (0,_socket__WEBPACK_IMPORTED_MODULE_3__.emitToRestaurant)(`new-order-${order.restaurantId}`, order.restaurantId, createdOrder);\n        // Também emite no novo formato (sem sufixo)\n        (0,_socket__WEBPACK_IMPORTED_MODULE_3__.emitToRestaurant)('new-order', order.restaurantId, createdOrder);\n        return createdOrder;\n    } catch (error) {\n        console.error('Erro ao criar pedido:', error);\n        throw new Error('Erro ao criar pedido');\n    }\n}\nasync function updateOrderStatus(orderId, status, message) {\n    try {\n        console.log('MongoDB Service: Iniciando atualização de status do pedido', {\n            orderId,\n            status,\n            message\n        });\n        const { db } = await (0,_mongodb__WEBPACK_IMPORTED_MODULE_1__.connectToDatabase)();\n        // Verifica se o ID é válido\n        let objectId;\n        try {\n            objectId = new mongodb__WEBPACK_IMPORTED_MODULE_0__.ObjectId(orderId);\n            console.log('MongoDB Service: ID do pedido válido', orderId);\n        } catch (error) {\n            console.error('MongoDB Service: ID do pedido inválido', orderId);\n            throw new Error('ID do pedido inválido');\n        }\n        // Atualiza o pedido\n        const updateResult = await db.collection('orders').updateOne({\n            _id: objectId\n        }, {\n            $set: {\n                status,\n                updatedAt: new Date().toISOString()\n            }\n        });\n        console.log('MongoDB Service: Resultado da atualização', {\n            orderId,\n            matchedCount: updateResult.matchedCount,\n            modifiedCount: updateResult.modifiedCount\n        });\n        if (updateResult.matchedCount === 0) {\n            console.error('MongoDB Service: Pedido não encontrado', orderId);\n            throw new Error('Pedido não encontrado');\n        }\n        // Busca o pedido atualizado para enviar via WebSocket\n        const updatedOrder = await db.collection('orders').findOne({\n            _id: objectId\n        });\n        if (!updatedOrder) {\n            console.error('MongoDB Service: Pedido não encontrado após atualização', orderId);\n            throw new Error('Pedido não encontrado após atualização');\n        }\n        console.log('MongoDB Service: Pedido atualizado com sucesso', {\n            orderId,\n            status,\n            restaurantId: updatedOrder.restaurantId\n        });\n        // Emite evento via Socket.IO para notificar sobre a atualização do pedido\n        const emitResult = (0,_socket__WEBPACK_IMPORTED_MODULE_3__.emitToRestaurant)(`order-updated-${updatedOrder.restaurantId}`, updatedOrder.restaurantId, updatedOrder);\n        console.log('MongoDB Service: Resultado da emissão do evento', {\n            event: `order-updated-${updatedOrder.restaurantId}`,\n            room: updatedOrder.restaurantId,\n            result: emitResult\n        });\n        return updatedOrder;\n    } catch (error) {\n        console.error('MongoDB Service: Erro ao atualizar status do pedido:', error);\n        throw error;\n    }\n}\n// Funções para Relatórios\nasync function getOrderStats(restaurantId, startDate, endDate) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const db = client.db('cardapio_digital');\n    const ordersCollection = db.collection('orders');\n    console.log('getOrderStats - Parâmetros recebidos:', {\n        restaurantId,\n        startDate: startDate.toISOString(),\n        endDate: endDate.toISOString()\n    });\n    // Buscar todos os pedidos do restaurante e filtrar por data em memória\n    const allOrders = await ordersCollection.find({\n        restaurantId\n    }).toArray();\n    // Filtra pedidos por data\n    const startTimestamp = startDate.getTime();\n    const endTimestamp = endDate.getTime();\n    const filteredOrders = allOrders.filter((order)=>{\n        // Converte a string de data para timestamp\n        const orderDate = new Date(order.createdAt);\n        const orderTimestamp = orderDate.getTime();\n        return orderTimestamp >= startTimestamp && orderTimestamp <= endTimestamp && ![\n            'cancelled',\n            'rejected'\n        ].includes(order.status);\n    });\n    console.log(`getOrderStats - Encontrados ${filteredOrders.length} pedidos no período`);\n    // Calcula estatísticas básicas\n    const totalOrders = filteredOrders.length;\n    const totalRevenue = filteredOrders.reduce((sum, order)=>sum + (order.total || 0), 0);\n    const averageTicket = totalOrders > 0 ? totalRevenue / totalOrders : 0;\n    // Calcula tempo médio de entrega (pedidos delivery)\n    const deliveryOrders = filteredOrders.filter((o)=>o.orderType === 'delivery' && o.statusUpdates && o.statusUpdates.length > 0);\n    let deliveryTime = 0;\n    if (deliveryOrders.length > 0) {\n        const totalDeliveryTime = deliveryOrders.reduce((sum, order)=>{\n            const lastUpdate = order.statusUpdates[order.statusUpdates.length - 1];\n            if (lastUpdate && lastUpdate.timestamp) {\n                const start = new Date(order.createdAt).getTime();\n                const end = new Date(lastUpdate.timestamp).getTime();\n                return sum + (end - start) / 60000 // minutos\n                ;\n            }\n            return sum;\n        }, 0);\n        deliveryTime = totalDeliveryTime / deliveryOrders.length;\n    }\n    // Produtos mais vendidos\n    const productsMap = new Map();\n    filteredOrders.forEach((order)=>{\n        if (order.items && Array.isArray(order.items)) {\n            order.items.forEach((item)=>{\n                const id = item.id || item.productId;\n                if (!productsMap.has(id)) {\n                    productsMap.set(id, {\n                        _id: id,\n                        name: item.name,\n                        quantity: 0,\n                        revenue: 0\n                    });\n                }\n                const product = productsMap.get(id);\n                product.quantity += item.quantity || 1;\n                product.revenue += item.price * (item.quantity || 1);\n            });\n        }\n    });\n    const bestSellingProducts = Array.from(productsMap.values()).sort((a, b)=>b.quantity - a.quantity).slice(0, 10).map(({ _id, ...rest })=>({\n            ...rest\n        }));\n    // Faturamento por dia\n    const revenueByDayMap = new Map();\n    filteredOrders.forEach((order)=>{\n        const date = new Date(order.createdAt);\n        const dateString = date.toISOString().split('T')[0] // YYYY-MM-DD\n        ;\n        if (!revenueByDayMap.has(dateString)) {\n            revenueByDayMap.set(dateString, 0);\n        }\n        revenueByDayMap.set(dateString, revenueByDayMap.get(dateString) + (order.total || 0));\n    });\n    const revenueByDay = Array.from(revenueByDayMap.entries()).map(([date, value])=>({\n            date,\n            value\n        })).sort((a, b)=>a.date.localeCompare(b.date));\n    // Pedidos por horário\n    const ordersByHourMap = new Map();\n    filteredOrders.forEach((order)=>{\n        const date = new Date(order.createdAt);\n        const hour = `${date.getHours()}h`;\n        if (!ordersByHourMap.has(hour)) {\n            ordersByHourMap.set(hour, 0);\n        }\n        ordersByHourMap.set(hour, ordersByHourMap.get(hour) + 1);\n    });\n    const ordersByHour = Array.from(ordersByHourMap.entries()).map(([hour, quantity])=>({\n            hour,\n            quantity\n        })).sort((a, b)=>{\n        const hourA = parseInt(a.hour);\n        const hourB = parseInt(b.hour);\n        return hourA - hourB;\n    });\n    // Retorna resultado final\n    return {\n        totalOrders,\n        totalRevenue,\n        averageTicket,\n        deliveryTime,\n        bestSellingProducts,\n        revenueByDay,\n        ordersByHour\n    };\n}\nasync function getBestSellingProducts(restaurantId, startDate, endDate) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const collection = client.db('cardapio_digital').collection('orders');\n    return collection.aggregate([\n        {\n            $match: {\n                restaurantId,\n                createdAt: {\n                    $gte: startDate,\n                    $lte: endDate\n                },\n                status: {\n                    $nin: [\n                        'cancelled',\n                        'rejected'\n                    ]\n                }\n            }\n        },\n        {\n            $unwind: '$items'\n        },\n        {\n            $group: {\n                _id: '$items.id',\n                name: {\n                    $first: '$items.name'\n                },\n                quantity: {\n                    $sum: '$items.quantity'\n                },\n                revenue: {\n                    $sum: {\n                        $multiply: [\n                            '$items.price',\n                            '$items.quantity'\n                        ]\n                    }\n                }\n            }\n        },\n        {\n            $sort: {\n                quantity: -1\n            }\n        },\n        {\n            $limit: 5\n        }\n    ]).toArray();\n}\n// Funções para Dashboard\nasync function getDashboardStats(restaurantId) {\n    const client = await _mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n    const ordersCollection = client.db('cardapio_digital').collection('orders');\n    // Data de hoje\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    // Pedidos de hoje\n    const todayOrders = await ordersCollection.countDocuments({\n        restaurantId,\n        createdAt: {\n            $gte: today\n        }\n    });\n    // Pedidos em andamento\n    const activeOrders = await ordersCollection.countDocuments({\n        restaurantId,\n        status: {\n            $in: [\n                'pending',\n                'confirmed',\n                'preparing',\n                'ready',\n                'out_for_delivery'\n            ]\n        }\n    });\n    // Faturamento do dia\n    const todayRevenue = await ordersCollection.aggregate([\n        {\n            $match: {\n                restaurantId,\n                createdAt: {\n                    $gte: today\n                },\n                status: {\n                    $nin: [\n                        'cancelled',\n                        'rejected'\n                    ]\n                }\n            }\n        },\n        {\n            $group: {\n                _id: null,\n                total: {\n                    $sum: '$total'\n                }\n            }\n        }\n    ]).toArray();\n    // Ticket médio do dia\n    const averageTicket = todayOrders > 0 ? (todayRevenue[0]?.total || 0) / todayOrders : 0;\n    // Buscar pedidos recentes\n    const recentOrders = await ordersCollection.find({\n        restaurantId\n    }).sort({\n        createdAt: -1\n    }).limit(5).toArray();\n    // Formata os pedidos para retornar\n    const formattedOrders = recentOrders.map((order)=>({\n            ...order,\n            id: order._id.toString(),\n            _id: undefined\n        }));\n    return {\n        todayOrders,\n        activeOrders,\n        todayRevenue: todayRevenue[0]?.total || 0,\n        averageTicket,\n        recentOrders: formattedOrders\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0JGLGFBQWEzSyxHQUFHLENBQUNILENBQUFBLFFBQVU7WUFDakQsR0FBR0EsS0FBSztZQUNSSyxJQUFJTCxNQUFNTSxHQUFHLENBQUNDLFFBQVE7WUFDdEJELEtBQUswQztRQUNQO0lBRUEsT0FBTztRQUNMeUg7UUFDQUU7UUFDQUUsY0FBY0EsWUFBWSxDQUFDLEVBQUUsRUFBRTFELFNBQVM7UUFDeENDO1FBQ0EwRCxjQUFjRTtJQUNoQjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvb3RhdmlvbWFyY28vRGVza3RvcC9Qcm9qZXRvcy9HbG9iYWwgTGl2ZS9rcmF0b2RlbGl2L2NhcmRhcGlvX2xhdGVzdC9zcmMvbGliL21vbmdvZGItc2VydmljZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgT2JqZWN0SWQgfSBmcm9tICdtb25nb2RiJ1xuaW1wb3J0IGNsaWVudFByb21pc2UgZnJvbSAnLi9tb25nb2RiJ1xuaW1wb3J0IHsgQ2F0ZWdvcnksIFByb2R1Y3QgfSBmcm9tICdAL3R5cGVzL3Jlc3RhdXJhbnQnXG5pbXBvcnQgeyBPcmRlciB9IGZyb20gJ0AvdHlwZXMvb3JkZXInXG5pbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJ1xuaW1wb3J0IHsgZW1pdFRvUmVzdGF1cmFudCB9IGZyb20gJy4vc29ja2V0J1xuaW1wb3J0IHsgY29ubmVjdFRvRGF0YWJhc2UgfSBmcm9tICcuL21vbmdvZGInXG5cbi8vIEZ1bsOnw7VlcyBwYXJhIENhdGVnb3JpYXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXRlZ29yaWVzKHJlc3RhdXJhbnRJZDogc3RyaW5nKSB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGNsaWVudFByb21pc2VcbiAgY29uc3QgY29sbGVjdGlvbiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpLmNvbGxlY3Rpb24oJ2NhdGVnb3JpZXMnKVxuICBcbiAgY29uc29sZS5sb2coJ0J1c2NhbmRvIGNhdGVnb3JpYXMgcGFyYSByZXN0YXVyYW50SWQ6JywgcmVzdGF1cmFudElkKVxuICBcbiAgY29uc3QgY2F0ZWdvcmllcyA9IGF3YWl0IGNvbGxlY3Rpb25cbiAgICAuZmluZCh7IHJlc3RhdXJhbnRJZCB9KVxuICAgIC5zb3J0KHsgb3JkZXI6IDEgfSlcbiAgICAudG9BcnJheSgpXG5cbiAgLy8gTm9ybWFsaXphIG9zIElEcyBhbnRlcyBkZSByZXRvcm5hclxuICBjb25zdCBub3JtYWxpemVkQ2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubWFwKGNhdGVnb3J5ID0+ICh7XG4gICAgLi4uY2F0ZWdvcnksXG4gICAgaWQ6IGNhdGVnb3J5Ll9pZC50b1N0cmluZygpLCAvLyBHYXJhbnRlIHF1ZSBzZW1wcmUgdGVtb3MgdW0gaWQgZW0gc3RyaW5nXG4gIH0pKVxuXG4gIGNvbnNvbGUubG9nKCdDYXRlZ29yaWFzIGVuY29udHJhZGFzOicsIG5vcm1hbGl6ZWRDYXRlZ29yaWVzKVxuICByZXR1cm4gbm9ybWFsaXplZENhdGVnb3JpZXNcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNhdGVnb3J5KGNhdGVnb3J5OiBPbWl0PENhdGVnb3J5LCAnaWQnPikge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlXG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBjbGllbnQuZGIoJ2NhcmRhcGlvX2RpZ2l0YWwnKS5jb2xsZWN0aW9uKCdjYXRlZ29yaWVzJylcbiAgXG4gIGNvbnNvbGUubG9nKCdDcmlhbmRvIGNhdGVnb3JpYSBjb20gZGFkb3M6JywgY2F0ZWdvcnkpXG4gIFxuICAvLyBHYXJhbnRlIHF1ZSBvIHJlc3RhdXJhbnRJZCBlc3TDoSBwcmVzZW50ZVxuICBpZiAoIWNhdGVnb3J5LnJlc3RhdXJhbnRJZCkge1xuICAgIHRocm93IG5ldyBFcnJvcigncmVzdGF1cmFudElkIMOpIG9icmlnYXTDs3JpbyBwYXJhIGNyaWFyIHVtYSBjYXRlZ29yaWEnKVxuICB9XG5cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29sbGVjdGlvbi5pbnNlcnRPbmUoY2F0ZWdvcnkpXG4gIGNvbnN0IGNyZWF0ZWRDYXRlZ29yeSA9IHsgXG4gICAgLi4uY2F0ZWdvcnksIFxuICAgIGlkOiByZXN1bHQuaW5zZXJ0ZWRJZC50b1N0cmluZygpLFxuICAgIF9pZDogcmVzdWx0Lmluc2VydGVkSWRcbiAgfVxuICBcbiAgY29uc29sZS5sb2coJ0NhdGVnb3JpYSBjcmlhZGEgY29tIHN1Y2Vzc286JywgY3JlYXRlZENhdGVnb3J5KVxuICByZXR1cm4gY3JlYXRlZENhdGVnb3J5XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDYXRlZ29yeShpZDogc3RyaW5nLCBjYXRlZ29yeTogUGFydGlhbDxDYXRlZ29yeT4pIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgY2xpZW50UHJvbWlzZVxuICBjb25zdCBjb2xsZWN0aW9uID0gY2xpZW50LmRiKCdjYXJkYXBpb19kaWdpdGFsJykuY29sbGVjdGlvbignY2F0ZWdvcmllcycpXG4gIFxuICBjb25zb2xlLmxvZygnSW5pY2lhbmRvIGF0dWFsaXphw6fDo28gZGEgY2F0ZWdvcmlhIG5vIE1vbmdvREI6JywgeyBpZCwgY2F0ZWdvcnkgfSlcblxuICB0cnkge1xuICAgIC8vIFJlbW92ZSBjYW1wb3MgcXVlIG7Do28gZGV2ZW0gc2VyIGF0dWFsaXphZG9zXG4gICAgY29uc3QgeyBfaWQsIGlkOiBjYXRlZ29yeUlkLCAuLi51cGRhdGVEYXRhIH0gPSBjYXRlZ29yeVxuXG4gICAgLy8gUHJpbWVpcm8gYnVzY2EgYSBjYXRlZ29yaWEgZXhpc3RlbnRlXG4gICAgY29uc3QgZXhpc3RpbmdDYXRlZ29yeSA9IGF3YWl0IGNvbGxlY3Rpb24uZmluZE9uZSh7IFxuICAgICAgX2lkOiBuZXcgT2JqZWN0SWQoaWQpXG4gICAgfSlcblxuICAgIGNvbnNvbGUubG9nKCdDYXRlZ29yaWEgZXhpc3RlbnRlOicsIGV4aXN0aW5nQ2F0ZWdvcnkpXG5cbiAgICBpZiAoIWV4aXN0aW5nQ2F0ZWdvcnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NhdGVnb3JpYSBuw6NvIGVuY29udHJhZGE6JywgaWQpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NhdGVnb3JpYSBuw6NvIGVuY29udHJhZGEnKVxuICAgIH1cblxuICAgIC8vIE1hbnTDqW0gbyByZXN0YXVyYW50SWQgb3JpZ2luYWxcbiAgICBjb25zdCByZXN0YXVyYW50SWQgPSBleGlzdGluZ0NhdGVnb3J5LnJlc3RhdXJhbnRJZFxuXG4gICAgLy8gVmVyaWZpY2Egc2UgbyByZXN0YXVyYW50SWQgZGEgcmVxdWlzacOnw6NvIGNvcnJlc3BvbmRlIGFvIGRhIGNhdGVnb3JpYVxuICAgIGlmIChjYXRlZ29yeS5yZXN0YXVyYW50SWQgJiYgY2F0ZWdvcnkucmVzdGF1cmFudElkICE9PSByZXN0YXVyYW50SWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RlbnRhdGl2YSBkZSBlZGnDp8OjbyBuw6NvIGF1dG9yaXphZGE6Jywge1xuICAgICAgICBjYXRlZ29yaWFSZXN0YXVyYW50SWQ6IHJlc3RhdXJhbnRJZCxcbiAgICAgICAgcmVxdWVzdFJlc3RhdXJhbnRJZDogY2F0ZWdvcnkucmVzdGF1cmFudElkXG4gICAgICB9KVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdOw6NvIGF1dG9yaXphZG8gYSBlZGl0YXIgZXN0YSBjYXRlZ29yaWEnKVxuICAgIH1cblxuICAgIC8vIFByZXBhcmEgb3MgZGFkb3MgcGFyYSBhdHVhbGl6YcOnw6NvXG4gICAgY29uc3QgdXBkYXRlRG9jID0ge1xuICAgICAgJHNldDoge1xuICAgICAgICBuYW1lOiB1cGRhdGVEYXRhLm5hbWUgfHwgZXhpc3RpbmdDYXRlZ29yeS5uYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogdXBkYXRlRGF0YS5kZXNjcmlwdGlvbiB8fCBleGlzdGluZ0NhdGVnb3J5LmRlc2NyaXB0aW9uLFxuICAgICAgICBvcmRlcjogdXBkYXRlRGF0YS5vcmRlciA/PyBleGlzdGluZ0NhdGVnb3J5Lm9yZGVyLFxuICAgICAgICByZXN0YXVyYW50SWQsXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdEYWRvcyBwYXJhIGF0dWFsaXphw6fDo286JywgdXBkYXRlRG9jKVxuXG4gICAgLy8gRmF6IGEgYXR1YWxpemHDp8Ojb1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbGxlY3Rpb24uZmluZE9uZUFuZFVwZGF0ZShcbiAgICAgIHsgX2lkOiBuZXcgT2JqZWN0SWQoaWQpIH0sXG4gICAgICB1cGRhdGVEb2MsXG4gICAgICB7IFxuICAgICAgICByZXR1cm5Eb2N1bWVudDogJ2FmdGVyJ1xuICAgICAgfVxuICAgIClcblxuICAgIGNvbnNvbGUubG9nKCdSZXN1bHRhZG8gZGEgYXR1YWxpemHDp8OjbzonLCByZXN1bHQpXG5cbiAgICAvLyBOYSB2ZXJzw6NvIG1haXMgcmVjZW50ZSBkbyBNb25nb0RCLCBvIHJlc3VsdGFkbyB2ZW0gZGlyZXRhbWVudGUgbm8gb2JqZXRvXG4gICAgY29uc3QgdXBkYXRlZERvYyA9IHJlc3VsdFxuXG4gICAgaWYgKCF1cGRhdGVkRG9jKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWxoYSBuYSBhdHVhbGl6YcOnw6NvIC0gZG9jdW1lbnRvIG7Do28gZW5jb250cmFkbzonLCB7IGlkLCByZXN1bHQgfSlcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2F0ZWdvcmlhIG7Do28gZW5jb250cmFkYSBvdSBuw6NvIHDDtGRlIHNlciBhdHVhbGl6YWRhJylcbiAgICB9XG5cbiAgICAvLyBGb3JtYXRhIG8gcmVzdWx0YWRvIHBhcmEgcmV0b3JuYXJcbiAgICBjb25zdCB1cGRhdGVkQ2F0ZWdvcnkgPSB7XG4gICAgICAuLi51cGRhdGVkRG9jLFxuICAgICAgaWQ6IHVwZGF0ZWREb2MuX2lkLnRvU3RyaW5nKClcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgY2FtcG9zIHF1ZSBuw6NvIGRldmVtIHNlciByZXRvcm5hZG9zXG4gICAgZGVsZXRlIHVwZGF0ZWRDYXRlZ29yeS5faWRcblxuICAgIGNvbnNvbGUubG9nKCdDYXRlZ29yaWEgYXR1YWxpemFkYSBjb20gc3VjZXNzbzonLCB1cGRhdGVkQ2F0ZWdvcnkpXG4gICAgcmV0dXJuIHVwZGF0ZWRDYXRlZ29yeVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gYXR1YWxpemFyIGNhdGVnb3JpYSBubyBNb25nb0RCOicsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNhdGVnb3J5KGlkOiBzdHJpbmcpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgY2xpZW50UHJvbWlzZVxuICBjb25zdCBkYiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpXG4gIFxuICAvLyBQcmltZWlybyBlbmNvbnRyYSB0b2RvcyBvcyBwcm9kdXRvcyBkYSBjYXRlZ29yaWFcbiAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKCdwcm9kdWN0cycpXG4gICAgLmZpbmQoeyBjYXRlZ29yeUlkOiBpZCB9KVxuICAgIC50b0FycmF5KClcblxuICAvLyBEZWxldGEgYXMgaW1hZ2VucyBkbyBTdXBhYmFzZSBTdG9yYWdlXG4gIGZvciAoY29uc3QgcHJvZHVjdCBvZiBwcm9kdWN0cykge1xuICAgIGlmIChwcm9kdWN0LmltYWdlKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpbWFnZVVybCA9IG5ldyBVUkwocHJvZHVjdC5pbWFnZSlcbiAgICAgICAgY29uc3QgaW1hZ2VQYXRoID0gaW1hZ2VVcmwucGF0aG5hbWUuc3BsaXQoJy9wdWJsaWMvJylbMV1cbiAgICAgICAgaWYgKGltYWdlUGF0aCkge1xuICAgICAgICAgIC8vIERlbGV0YSBhIGltYWdlbSBkbyBzdG9yYWdlXG4gICAgICAgICAgYXdhaXQgc3VwYWJhc2Uuc3RvcmFnZVxuICAgICAgICAgICAgLmZyb20oJ3Jlc3RhdXJhbnQtaW1hZ2VzJylcbiAgICAgICAgICAgIC5yZW1vdmUoW2ltYWdlUGF0aF0pXG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gZGVsZXRhciBpbWFnZW0gZG8gcHJvZHV0bzonLCBlcnJvcilcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBEZWxldGEgdG9kb3Mgb3MgcHJvZHV0b3MgZGEgY2F0ZWdvcmlhXG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ3Byb2R1Y3RzJylcbiAgICAuZGVsZXRlTWFueSh7IGNhdGVnb3J5SWQ6IGlkIH0pXG5cbiAgLy8gUG9yIGZpbSwgZGVsZXRhIGEgY2F0ZWdvcmlhXG4gIGF3YWl0IGRiLmNvbGxlY3Rpb24oJ2NhdGVnb3JpZXMnKVxuICAgIC5kZWxldGVPbmUoeyBfaWQ6IG5ldyBPYmplY3RJZChpZCkgfSlcbn1cblxuLy8gRnVuw6fDtWVzIHBhcmEgUHJvZHV0b3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0cyhyZXN0YXVyYW50SWQ6IHN0cmluZykge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlXG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBjbGllbnQuZGIoJ2NhcmRhcGlvX2RpZ2l0YWwnKS5jb2xsZWN0aW9uKCdwcm9kdWN0cycpXG4gIFxuICBjb25zb2xlLmxvZygnQnVzY2FuZG8gcHJvZHV0b3MgcGFyYSByZXN0YXVyYW50SWQ6JywgcmVzdGF1cmFudElkKVxuICBcbiAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBjb2xsZWN0aW9uXG4gICAgLmZpbmQoeyByZXN0YXVyYW50SWQgfSlcbiAgICAudG9BcnJheSgpXG5cbiAgLy8gTm9ybWFsaXphIG9zIGRhZG9zIGFudGVzIGRlIHJldG9ybmFyXG4gIGNvbnN0IG5vcm1hbGl6ZWRQcm9kdWN0cyA9IHByb2R1Y3RzLm1hcChwcm9kdWN0ID0+ICh7XG4gICAgLi4ucHJvZHVjdCxcbiAgICBpZDogcHJvZHVjdC5faWQudG9TdHJpbmcoKSwgLy8gQ29udmVydGUgT2JqZWN0SWQgcGFyYSBzdHJpbmdcbiAgICBpbWFnZTogcHJvZHVjdC5pbWFnZSB8fCBwcm9kdWN0LmltYWdlVXJsLCAvLyBHYXJhbnRlIGNvbXBhdGliaWxpZGFkZSBjb20gYW1ib3Mgb3MgY2FtcG9zXG4gICAgaW1hZ2VVcmw6IHVuZGVmaW5lZCAvLyBSZW1vdmUgY2FtcG8gZHVwbGljYWRvXG4gIH0pKVxuXG4gIGNvbnNvbGUubG9nKCdQcm9kdXRvcyBlbmNvbnRyYWRvczonLCBub3JtYWxpemVkUHJvZHVjdHMpXG4gIFxuICByZXR1cm4gbm9ybWFsaXplZFByb2R1Y3RzXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9kdWN0c0J5Q2F0ZWdvcnkocmVzdGF1cmFudElkOiBzdHJpbmcsIGNhdGVnb3J5SWQ6IHN0cmluZykge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlXG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBjbGllbnQuZGIoJ2NhcmRhcGlvX2RpZ2l0YWwnKS5jb2xsZWN0aW9uKCdwcm9kdWN0cycpXG4gIFxuICByZXR1cm4gY29sbGVjdGlvblxuICAgIC5maW5kKHsgcmVzdGF1cmFudElkLCBjYXRlZ29yeUlkIH0pXG4gICAgLnRvQXJyYXkoKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlUHJvZHVjdChwcm9kdWN0OiBPbWl0PFByb2R1Y3QsICdpZCc+KSB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGNsaWVudFByb21pc2VcbiAgY29uc3QgY29sbGVjdGlvbiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpLmNvbGxlY3Rpb24oJ3Byb2R1Y3RzJylcbiAgXG4gIC8vIE5vcm1hbGl6YSBvcyBjYW1wb3MgZGEgaW1hZ2VtIGUgZ2FyYW50ZSB0b2RvcyBvcyBjYW1wb3Mgb2JyaWdhdMOzcmlvc1xuICBjb25zdCBub3JtYWxpemVkUHJvZHVjdCA9IHtcbiAgICAuLi5wcm9kdWN0LFxuICAgIGltYWdlOiBwcm9kdWN0LmltYWdlVXJsIHx8IHByb2R1Y3QuaW1hZ2UsIC8vIEFjZWl0YSBhbWJvcyBvcyBjYW1wb3NcbiAgICBpbWFnZVVybDogdW5kZWZpbmVkLCAvLyBSZW1vdmUgbyBjYW1wbyBpbWFnZVVybFxuICAgIGF2YWlsYWJsZTogcHJvZHVjdC5hdmFpbGFibGUgPz8gdHJ1ZSxcbiAgICBmZWF0dXJlZDogcHJvZHVjdC5mZWF0dXJlZCA/PyBmYWxzZSxcbiAgICBhZGRpdGlvbnM6IHByb2R1Y3QuYWRkaXRpb25zIHx8IFtdLFxuICAgIGlzUGl6emE6IHByb2R1Y3QuaXNQaXp6YSA/PyBmYWxzZSxcbiAgICBhbGxvd0hhbGZIYWxmOiBwcm9kdWN0LmFsbG93SGFsZkhhbGYgPz8gZmFsc2UsXG4gICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpXG4gIH1cblxuICBjb25zb2xlLmxvZygnU2FsdmFuZG8gcHJvZHV0byBubyBNb25nb0RCOicsIG5vcm1hbGl6ZWRQcm9kdWN0KVxuICBcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29sbGVjdGlvbi5pbnNlcnRPbmUobm9ybWFsaXplZFByb2R1Y3QpXG4gIGNvbnN0IGNyZWF0ZWRQcm9kdWN0ID0geyBcbiAgICAuLi5ub3JtYWxpemVkUHJvZHVjdCwgXG4gICAgaWQ6IHJlc3VsdC5pbnNlcnRlZElkLnRvU3RyaW5nKCksXG4gICAgX2lkOiB1bmRlZmluZWQgLy8gUmVtb3ZlIG8gX2lkIGRhIHJlc3Bvc3RhXG4gIH1cbiAgY29uc29sZS5sb2coJ1Byb2R1dG8gc2Fsdm86JywgY3JlYXRlZFByb2R1Y3QpXG4gIFxuICByZXR1cm4gY3JlYXRlZFByb2R1Y3Rcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVByb2R1Y3QoaWQ6IHN0cmluZywgcHJvZHVjdDogUGFydGlhbDxQcm9kdWN0Pikge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlXG4gIGNvbnN0IGNvbGxlY3Rpb24gPSBjbGllbnQuZGIoJ2NhcmRhcGlvX2RpZ2l0YWwnKS5jb2xsZWN0aW9uKCdwcm9kdWN0cycpXG4gIFxuICBjb25zb2xlLmxvZygnSW5pY2lhbmRvIGF0dWFsaXphw6fDo28gZG8gcHJvZHV0bzonLCB7IGlkLCBwcm9kdWN0IH0pXG5cbiAgdHJ5IHtcbiAgICAvLyBSZW1vdmUgY2FtcG9zIHF1ZSBuw6NvIGRldmVtIHNlciBhdHVhbGl6YWRvc1xuICAgIGNvbnN0IHsgX2lkLCBpZDogcHJvZHVjdElkLCAuLi51cGRhdGVEYXRhIH0gPSBwcm9kdWN0XG5cbiAgICAvLyBQcmltZWlybyBidXNjYSBvIHByb2R1dG8gZXhpc3RlbnRlXG4gICAgY29uc3QgZXhpc3RpbmdQcm9kdWN0ID0gYXdhaXQgY29sbGVjdGlvbi5maW5kT25lKHsgXG4gICAgICBfaWQ6IG5ldyBPYmplY3RJZChpZClcbiAgICB9KVxuXG4gICAgY29uc29sZS5sb2coJ1Byb2R1dG8gZXhpc3RlbnRlOicsIGV4aXN0aW5nUHJvZHVjdClcblxuICAgIGlmICghZXhpc3RpbmdQcm9kdWN0KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdQcm9kdXRvIG7Do28gZW5jb250cmFkbzonLCBpZClcbiAgICAgIHRocm93IG5ldyBFcnJvcignUHJvZHV0byBuw6NvIGVuY29udHJhZG8nKVxuICAgIH1cblxuICAgIC8vIE1hbnTDqW0gbyByZXN0YXVyYW50SWQgb3JpZ2luYWxcbiAgICBjb25zdCByZXN0YXVyYW50SWQgPSBleGlzdGluZ1Byb2R1Y3QucmVzdGF1cmFudElkXG5cbiAgICAvLyBWZXJpZmljYSBzZSBvIHJlc3RhdXJhbnRJZCBkYSByZXF1aXNpw6fDo28gY29ycmVzcG9uZGUgYW8gZG8gcHJvZHV0b1xuICAgIGlmIChwcm9kdWN0LnJlc3RhdXJhbnRJZCAmJiBwcm9kdWN0LnJlc3RhdXJhbnRJZCAhPT0gcmVzdGF1cmFudElkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdUZW50YXRpdmEgZGUgZWRpw6fDo28gbsOjbyBhdXRvcml6YWRhOicsIHtcbiAgICAgICAgcHJvZHV0b1Jlc3RhdXJhbnRJZDogcmVzdGF1cmFudElkLFxuICAgICAgICByZXF1ZXN0UmVzdGF1cmFudElkOiBwcm9kdWN0LnJlc3RhdXJhbnRJZFxuICAgICAgfSlcbiAgICAgIHRocm93IG5ldyBFcnJvcignTsOjbyBhdXRvcml6YWRvIGEgZWRpdGFyIGVzdGUgcHJvZHV0bycpXG4gICAgfVxuXG4gICAgLy8gUHJlcGFyYSBvcyBkYWRvcyBwYXJhIGF0dWFsaXphw6fDo29cbiAgICBjb25zdCB1cGRhdGVEb2MgPSB7XG4gICAgICAkc2V0OiB7XG4gICAgICAgIG5hbWU6IHVwZGF0ZURhdGEubmFtZSB8fCBleGlzdGluZ1Byb2R1Y3QubmFtZSxcbiAgICAgICAgZGVzY3JpcHRpb246IHVwZGF0ZURhdGEuZGVzY3JpcHRpb24gfHwgZXhpc3RpbmdQcm9kdWN0LmRlc2NyaXB0aW9uLFxuICAgICAgICBwcmljZTogdXBkYXRlRGF0YS5wcmljZSA/PyBleGlzdGluZ1Byb2R1Y3QucHJpY2UsXG4gICAgICAgIGNhdGVnb3J5SWQ6IHVwZGF0ZURhdGEuY2F0ZWdvcnlJZCB8fCBleGlzdGluZ1Byb2R1Y3QuY2F0ZWdvcnlJZCxcbiAgICAgICAgYXZhaWxhYmxlOiB1cGRhdGVEYXRhLmF2YWlsYWJsZSA/PyBleGlzdGluZ1Byb2R1Y3QuYXZhaWxhYmxlLFxuICAgICAgICBmZWF0dXJlZDogdXBkYXRlRGF0YS5mZWF0dXJlZCA/PyBleGlzdGluZ1Byb2R1Y3QuZmVhdHVyZWQsXG4gICAgICAgIGFkZGl0aW9uczogdXBkYXRlRGF0YS5hZGRpdGlvbnMgfHwgZXhpc3RpbmdQcm9kdWN0LmFkZGl0aW9ucyxcbiAgICAgICAgaW1hZ2U6IHVwZGF0ZURhdGEuaW1hZ2UgPz8gZXhpc3RpbmdQcm9kdWN0LmltYWdlLFxuICAgICAgICBpc1BpenphOiB1cGRhdGVEYXRhLmlzUGl6emEgPz8gZXhpc3RpbmdQcm9kdWN0LmlzUGl6emEgPz8gZmFsc2UsXG4gICAgICAgIGFsbG93SGFsZkhhbGY6IHVwZGF0ZURhdGEuYWxsb3dIYWxmSGFsZiA/PyBleGlzdGluZ1Byb2R1Y3QuYWxsb3dIYWxmSGFsZiA/PyBmYWxzZSxcbiAgICAgICAgcmVzdGF1cmFudElkLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnRGFkb3MgcGFyYSBhdHVhbGl6YcOnw6NvOicsIHVwZGF0ZURvYylcblxuICAgIC8vIEZheiBhIGF0dWFsaXphw6fDo29cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmVBbmRVcGRhdGUoXG4gICAgICB7IF9pZDogbmV3IE9iamVjdElkKGlkKSB9LFxuICAgICAgdXBkYXRlRG9jLFxuICAgICAgeyBcbiAgICAgICAgcmV0dXJuRG9jdW1lbnQ6ICdhZnRlcidcbiAgICAgIH1cbiAgICApXG5cbiAgICBjb25zb2xlLmxvZygnUmVzdWx0YWRvIGRhIGF0dWFsaXphw6fDo286JywgcmVzdWx0KVxuXG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhbGhhIG5hIGF0dWFsaXphw6fDo28gLSBwcm9kdXRvIG7Do28gZW5jb250cmFkbzonLCB7IGlkLCByZXN1bHQgfSlcbiAgICAgIHRocm93IG5ldyBFcnJvcignUHJvZHV0byBuw6NvIGVuY29udHJhZG8gb3UgbsOjbyBww7RkZSBzZXIgYXR1YWxpemFkbycpXG4gICAgfVxuXG4gICAgLy8gRm9ybWF0YSBvIHJlc3VsdGFkbyBwYXJhIHJldG9ybmFyXG4gICAgY29uc3QgdXBkYXRlZFByb2R1Y3QgPSB7XG4gICAgICAuLi5yZXN1bHQsXG4gICAgICBpZDogcmVzdWx0Ll9pZC50b1N0cmluZygpXG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIGNhbXBvcyBxdWUgbsOjbyBkZXZlbSBzZXIgcmV0b3JuYWRvc1xuICAgIGRlbGV0ZSB1cGRhdGVkUHJvZHVjdC5faWRcblxuICAgIGNvbnNvbGUubG9nKCdQcm9kdXRvIGF0dWFsaXphZG8gY29tIHN1Y2Vzc286JywgdXBkYXRlZFByb2R1Y3QpXG4gICAgcmV0dXJuIHVwZGF0ZWRQcm9kdWN0XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBhdHVhbGl6YXIgcHJvZHV0bzonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVQcm9kdWN0KGlkOiBzdHJpbmcpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgY2xpZW50UHJvbWlzZVxuICBjb25zdCBjb2xsZWN0aW9uID0gY2xpZW50LmRiKCdjYXJkYXBpb19kaWdpdGFsJykuY29sbGVjdGlvbigncHJvZHVjdHMnKVxuICBcbiAgYXdhaXQgY29sbGVjdGlvbi5kZWxldGVPbmUoeyBfaWQ6IG5ldyBPYmplY3RJZChpZCkgfSlcbn1cblxuLy8gRnVuw6fDtWVzIHBhcmEgUGVkaWRvc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yZGVycyhyZXN0YXVyYW50SWQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZGIgfSA9IGF3YWl0IGNvbm5lY3RUb0RhdGFiYXNlKClcbiAgICBjb25zdCBvcmRlcnMgPSBhd2FpdCBkYlxuICAgICAgLmNvbGxlY3Rpb24oJ29yZGVycycpXG4gICAgICAuZmluZCh7IHJlc3RhdXJhbnRJZCB9KVxuICAgICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pXG4gICAgICAudG9BcnJheSgpXG5cbiAgICByZXR1cm4gb3JkZXJzXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBidXNjYXIgcGVkaWRvczonLCBlcnJvcilcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Vycm8gYW8gYnVzY2FyIHBlZGlkb3MnKVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcmRlcihpZDogc3RyaW5nKSB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGNsaWVudFByb21pc2VcbiAgY29uc3QgY29sbGVjdGlvbiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpLmNvbGxlY3Rpb24oJ29yZGVycycpXG4gIFxuICBjb25zb2xlLmxvZygnQnVzY2FuZG8gcGVkaWRvIGNvbSBJRDonLCBpZClcbiAgXG4gIHRyeSB7XG4gICAgY29uc3Qgb3JkZXIgPSBhd2FpdCBjb2xsZWN0aW9uLmZpbmRPbmUoeyBfaWQ6IG5ldyBPYmplY3RJZChpZCkgfSlcbiAgICBcbiAgICBpZiAoIW9yZGVyKSB7XG4gICAgICBjb25zb2xlLmxvZygnUGVkaWRvIG7Do28gZW5jb250cmFkbzonLCBpZClcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIFxuICAgIC8vIERlYnVnIHBhcmEgdmVyaWZpY2FyIGEgcHJlc2Vuw6dhIGRvIGNhbXBvIGNhdGVnb3JpYSBub3MgaXRlbnNcbiAgICBpZiAob3JkZXIuaXRlbXMgJiYgQXJyYXkuaXNBcnJheShvcmRlci5pdGVtcykpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdEZXB1cmHDp8OjbyBkZSBpdGVucyBkbyBwZWRpZG8gbm8gTW9uZ29EQjonKTtcbiAgICAgIG9yZGVyLml0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBNb25nb0RCIC0gSXRlbSAke2luZGV4ICsgMX06ICR7aXRlbS5uYW1lfWApO1xuICAgICAgICBjb25zb2xlLmxvZygnQ2FtcG9zIGRpc3BvbsOtdmVpczonLCBPYmplY3Qua2V5cyhpdGVtKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDYXRlZ29yaWEgZG8gaXRlbTonLCBpdGVtLmNhdGVnb3J5IHx8ICdOw4NPIEVOQ09OVFJBREEnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBOb3JtYWxpemEgbyBJRCBhbnRlcyBkZSByZXRvcm5hclxuICAgIGNvbnN0IG5vcm1hbGl6ZWRPcmRlciA9IHtcbiAgICAgIC4uLm9yZGVyLFxuICAgICAgaWQ6IG9yZGVyLl9pZC50b1N0cmluZygpLFxuICAgICAgX2lkOiBvcmRlci5faWQudG9TdHJpbmcoKSAvLyBNYW50w6ltIF9pZCBjb21vIHN0cmluZyBwYXJhIGNvbXBhdGliaWxpZGFkZVxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZygnUGVkaWRvIGVuY29udHJhZG86Jywgbm9ybWFsaXplZE9yZGVyKVxuICAgIHJldHVybiBub3JtYWxpemVkT3JkZXJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGJ1c2NhciBwZWRpZG86JywgZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlT3JkZXIob3JkZXI6IE9yZGVyKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBkYiB9ID0gYXdhaXQgY29ubmVjdFRvRGF0YWJhc2UoKVxuICAgIFxuICAgIC8vIEFkaWNpb25hIGRhdGEgZGUgY3JpYcOnw6NvIGUgZ2FyYW50ZSBxdWUgb3JkZXJUeXBlIGVzdGVqYSBkZWZpbmlkb1xuICAgIGNvbnN0IG9yZGVyV2l0aFRpbWVzdGFtcCA9IHtcbiAgICAgIC4uLm9yZGVyLFxuICAgICAgLy8gR2FyYW50ZSBxdWUgb3JkZXJUeXBlIGVzdGVqYSBkZWZpbmlkbyAoY29tcGF0aWJpbGlkYWRlIGNvbSBkZWxpdmVyeU1ldGhvZClcbiAgICAgIG9yZGVyVHlwZTogb3JkZXIub3JkZXJUeXBlIHx8IG9yZGVyLmRlbGl2ZXJ5TWV0aG9kIHx8ICdkZWxpdmVyeScsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oJ29yZGVycycpLmluc2VydE9uZShvcmRlcldpdGhUaW1lc3RhbXApXG4gICAgXG4gICAgLy8gUmVjdXBlcmEgbyBwZWRpZG8gY29tcGxldG8gY29tIG8gSUQgZ2VyYWRvXG4gICAgY29uc3QgY3JlYXRlZE9yZGVyID0ge1xuICAgICAgLi4ub3JkZXJXaXRoVGltZXN0YW1wLFxuICAgICAgX2lkOiByZXN1bHQuaW5zZXJ0ZWRJZC50b1N0cmluZygpXG4gICAgfVxuICAgIFxuICAgIC8vIEVtaXRlIGV2ZW50byB2aWEgU29ja2V0LklPIHBhcmEgbm90aWZpY2FyIHNvYnJlIG8gbm92byBwZWRpZG9cbiAgICBlbWl0VG9SZXN0YXVyYW50KFxuICAgICAgYG5ldy1vcmRlci0ke29yZGVyLnJlc3RhdXJhbnRJZH1gLFxuICAgICAgb3JkZXIucmVzdGF1cmFudElkLFxuICAgICAgY3JlYXRlZE9yZGVyXG4gICAgKVxuICAgIFxuICAgIC8vIFRhbWLDqW0gZW1pdGUgbm8gbm92byBmb3JtYXRvIChzZW0gc3VmaXhvKVxuICAgIGVtaXRUb1Jlc3RhdXJhbnQoXG4gICAgICAnbmV3LW9yZGVyJyxcbiAgICAgIG9yZGVyLnJlc3RhdXJhbnRJZCxcbiAgICAgIGNyZWF0ZWRPcmRlclxuICAgIClcbiAgICBcbiAgICByZXR1cm4gY3JlYXRlZE9yZGVyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBjcmlhciBwZWRpZG86JywgZXJyb3IpXG4gICAgdGhyb3cgbmV3IEVycm9yKCdFcnJvIGFvIGNyaWFyIHBlZGlkbycpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU9yZGVyU3RhdHVzKG9yZGVySWQ6IHN0cmluZywgc3RhdHVzOiBzdHJpbmcsIG1lc3NhZ2U/OiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnTW9uZ29EQiBTZXJ2aWNlOiBJbmljaWFuZG8gYXR1YWxpemHDp8OjbyBkZSBzdGF0dXMgZG8gcGVkaWRvJywge1xuICAgICAgb3JkZXJJZCxcbiAgICAgIHN0YXR1cyxcbiAgICAgIG1lc3NhZ2VcbiAgICB9KVxuICAgIFxuICAgIGNvbnN0IHsgZGIgfSA9IGF3YWl0IGNvbm5lY3RUb0RhdGFiYXNlKClcbiAgICBcbiAgICAvLyBWZXJpZmljYSBzZSBvIElEIMOpIHbDoWxpZG9cbiAgICBsZXQgb2JqZWN0SWQ7XG4gICAgdHJ5IHtcbiAgICAgIG9iamVjdElkID0gbmV3IE9iamVjdElkKG9yZGVySWQpO1xuICAgICAgY29uc29sZS5sb2coJ01vbmdvREIgU2VydmljZTogSUQgZG8gcGVkaWRvIHbDoWxpZG8nLCBvcmRlcklkKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNb25nb0RCIFNlcnZpY2U6IElEIGRvIHBlZGlkbyBpbnbDoWxpZG8nLCBvcmRlcklkKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJRCBkbyBwZWRpZG8gaW52w6FsaWRvJylcbiAgICB9XG4gICAgXG4gICAgLy8gQXR1YWxpemEgbyBwZWRpZG9cbiAgICBjb25zdCB1cGRhdGVSZXN1bHQgPSBhd2FpdCBkYi5jb2xsZWN0aW9uKCdvcmRlcnMnKS51cGRhdGVPbmUoXG4gICAgICB7IF9pZDogb2JqZWN0SWQgfSxcbiAgICAgIHsgXG4gICAgICAgICRzZXQ6IHsgXG4gICAgICAgICAgc3RhdHVzLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0gXG4gICAgICB9XG4gICAgKVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNb25nb0RCIFNlcnZpY2U6IFJlc3VsdGFkbyBkYSBhdHVhbGl6YcOnw6NvJywge1xuICAgICAgb3JkZXJJZCxcbiAgICAgIG1hdGNoZWRDb3VudDogdXBkYXRlUmVzdWx0Lm1hdGNoZWRDb3VudCxcbiAgICAgIG1vZGlmaWVkQ291bnQ6IHVwZGF0ZVJlc3VsdC5tb2RpZmllZENvdW50XG4gICAgfSlcbiAgICBcbiAgICBpZiAodXBkYXRlUmVzdWx0Lm1hdGNoZWRDb3VudCA9PT0gMCkge1xuICAgICAgY29uc29sZS5lcnJvcignTW9uZ29EQiBTZXJ2aWNlOiBQZWRpZG8gbsOjbyBlbmNvbnRyYWRvJywgb3JkZXJJZClcbiAgICAgIHRocm93IG5ldyBFcnJvcignUGVkaWRvIG7Do28gZW5jb250cmFkbycpXG4gICAgfVxuICAgIFxuICAgIC8vIEJ1c2NhIG8gcGVkaWRvIGF0dWFsaXphZG8gcGFyYSBlbnZpYXIgdmlhIFdlYlNvY2tldFxuICAgIGNvbnN0IHVwZGF0ZWRPcmRlciA9IGF3YWl0IGRiXG4gICAgICAuY29sbGVjdGlvbignb3JkZXJzJylcbiAgICAgIC5maW5kT25lKHsgX2lkOiBvYmplY3RJZCB9KVxuICAgIFxuICAgIGlmICghdXBkYXRlZE9yZGVyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNb25nb0RCIFNlcnZpY2U6IFBlZGlkbyBuw6NvIGVuY29udHJhZG8gYXDDs3MgYXR1YWxpemHDp8OjbycsIG9yZGVySWQpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BlZGlkbyBuw6NvIGVuY29udHJhZG8gYXDDs3MgYXR1YWxpemHDp8OjbycpXG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNb25nb0RCIFNlcnZpY2U6IFBlZGlkbyBhdHVhbGl6YWRvIGNvbSBzdWNlc3NvJywge1xuICAgICAgb3JkZXJJZCxcbiAgICAgIHN0YXR1cyxcbiAgICAgIHJlc3RhdXJhbnRJZDogdXBkYXRlZE9yZGVyLnJlc3RhdXJhbnRJZFxuICAgIH0pXG4gICAgXG4gICAgLy8gRW1pdGUgZXZlbnRvIHZpYSBTb2NrZXQuSU8gcGFyYSBub3RpZmljYXIgc29icmUgYSBhdHVhbGl6YcOnw6NvIGRvIHBlZGlkb1xuICAgIGNvbnN0IGVtaXRSZXN1bHQgPSBlbWl0VG9SZXN0YXVyYW50KFxuICAgICAgYG9yZGVyLXVwZGF0ZWQtJHt1cGRhdGVkT3JkZXIucmVzdGF1cmFudElkfWAsXG4gICAgICB1cGRhdGVkT3JkZXIucmVzdGF1cmFudElkLFxuICAgICAgdXBkYXRlZE9yZGVyXG4gICAgKVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNb25nb0RCIFNlcnZpY2U6IFJlc3VsdGFkbyBkYSBlbWlzc8OjbyBkbyBldmVudG8nLCB7XG4gICAgICBldmVudDogYG9yZGVyLXVwZGF0ZWQtJHt1cGRhdGVkT3JkZXIucmVzdGF1cmFudElkfWAsXG4gICAgICByb29tOiB1cGRhdGVkT3JkZXIucmVzdGF1cmFudElkLFxuICAgICAgcmVzdWx0OiBlbWl0UmVzdWx0XG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gdXBkYXRlZE9yZGVyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignTW9uZ29EQiBTZXJ2aWNlOiBFcnJvIGFvIGF0dWFsaXphciBzdGF0dXMgZG8gcGVkaWRvOicsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cblxuLy8gRnVuw6fDtWVzIHBhcmEgUmVsYXTDs3Jpb3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcmRlclN0YXRzKHJlc3RhdXJhbnRJZDogc3RyaW5nLCBzdGFydERhdGU6IERhdGUsIGVuZERhdGU6IERhdGUpIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgY2xpZW50UHJvbWlzZVxuICBjb25zdCBkYiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpXG4gIGNvbnN0IG9yZGVyc0NvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKCdvcmRlcnMnKVxuICBcbiAgY29uc29sZS5sb2coJ2dldE9yZGVyU3RhdHMgLSBQYXLDom1ldHJvcyByZWNlYmlkb3M6Jywge1xuICAgIHJlc3RhdXJhbnRJZCxcbiAgICBzdGFydERhdGU6IHN0YXJ0RGF0ZS50b0lTT1N0cmluZygpLFxuICAgIGVuZERhdGU6IGVuZERhdGUudG9JU09TdHJpbmcoKVxuICB9KVxuICBcbiAgLy8gQnVzY2FyIHRvZG9zIG9zIHBlZGlkb3MgZG8gcmVzdGF1cmFudGUgZSBmaWx0cmFyIHBvciBkYXRhIGVtIG1lbcOzcmlhXG4gIGNvbnN0IGFsbE9yZGVycyA9IGF3YWl0IG9yZGVyc0NvbGxlY3Rpb24uZmluZCh7IHJlc3RhdXJhbnRJZCB9KS50b0FycmF5KClcbiAgXG4gIC8vIEZpbHRyYSBwZWRpZG9zIHBvciBkYXRhXG4gIGNvbnN0IHN0YXJ0VGltZXN0YW1wID0gc3RhcnREYXRlLmdldFRpbWUoKVxuICBjb25zdCBlbmRUaW1lc3RhbXAgPSBlbmREYXRlLmdldFRpbWUoKVxuICBcbiAgY29uc3QgZmlsdGVyZWRPcmRlcnMgPSBhbGxPcmRlcnMuZmlsdGVyKG9yZGVyID0+IHtcbiAgICAvLyBDb252ZXJ0ZSBhIHN0cmluZyBkZSBkYXRhIHBhcmEgdGltZXN0YW1wXG4gICAgY29uc3Qgb3JkZXJEYXRlID0gbmV3IERhdGUob3JkZXIuY3JlYXRlZEF0KVxuICAgIGNvbnN0IG9yZGVyVGltZXN0YW1wID0gb3JkZXJEYXRlLmdldFRpbWUoKVxuICAgIFxuICAgIHJldHVybiBvcmRlclRpbWVzdGFtcCA+PSBzdGFydFRpbWVzdGFtcCAmJiBvcmRlclRpbWVzdGFtcCA8PSBlbmRUaW1lc3RhbXAgJiYgXG4gICAgICAgICAgICFbJ2NhbmNlbGxlZCcsICdyZWplY3RlZCddLmluY2x1ZGVzKG9yZGVyLnN0YXR1cylcbiAgfSlcbiAgXG4gIGNvbnNvbGUubG9nKGBnZXRPcmRlclN0YXRzIC0gRW5jb250cmFkb3MgJHtmaWx0ZXJlZE9yZGVycy5sZW5ndGh9IHBlZGlkb3Mgbm8gcGVyw61vZG9gKVxuICBcbiAgLy8gQ2FsY3VsYSBlc3RhdMOtc3RpY2FzIGLDoXNpY2FzXG4gIGNvbnN0IHRvdGFsT3JkZXJzID0gZmlsdGVyZWRPcmRlcnMubGVuZ3RoXG4gIGNvbnN0IHRvdGFsUmV2ZW51ZSA9IGZpbHRlcmVkT3JkZXJzLnJlZHVjZSgoc3VtLCBvcmRlcikgPT4gc3VtICsgKG9yZGVyLnRvdGFsIHx8IDApLCAwKVxuICBjb25zdCBhdmVyYWdlVGlja2V0ID0gdG90YWxPcmRlcnMgPiAwID8gdG90YWxSZXZlbnVlIC8gdG90YWxPcmRlcnMgOiAwXG4gIFxuICAvLyBDYWxjdWxhIHRlbXBvIG3DqWRpbyBkZSBlbnRyZWdhIChwZWRpZG9zIGRlbGl2ZXJ5KVxuICBjb25zdCBkZWxpdmVyeU9yZGVycyA9IGZpbHRlcmVkT3JkZXJzLmZpbHRlcihvID0+IG8ub3JkZXJUeXBlID09PSAnZGVsaXZlcnknICYmIG8uc3RhdHVzVXBkYXRlcyAmJiBvLnN0YXR1c1VwZGF0ZXMubGVuZ3RoID4gMClcbiAgbGV0IGRlbGl2ZXJ5VGltZSA9IDBcbiAgXG4gIGlmIChkZWxpdmVyeU9yZGVycy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgdG90YWxEZWxpdmVyeVRpbWUgPSBkZWxpdmVyeU9yZGVycy5yZWR1Y2UoKHN1bSwgb3JkZXIpID0+IHtcbiAgICAgIGNvbnN0IGxhc3RVcGRhdGUgPSBvcmRlci5zdGF0dXNVcGRhdGVzW29yZGVyLnN0YXR1c1VwZGF0ZXMubGVuZ3RoIC0gMV1cbiAgICAgIGlmIChsYXN0VXBkYXRlICYmIGxhc3RVcGRhdGUudGltZXN0YW1wKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUob3JkZXIuY3JlYXRlZEF0KS5nZXRUaW1lKClcbiAgICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUobGFzdFVwZGF0ZS50aW1lc3RhbXApLmdldFRpbWUoKVxuICAgICAgICByZXR1cm4gc3VtICsgKChlbmQgLSBzdGFydCkgLyA2MDAwMCkgLy8gbWludXRvc1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN1bVxuICAgIH0sIDApXG4gICAgXG4gICAgZGVsaXZlcnlUaW1lID0gdG90YWxEZWxpdmVyeVRpbWUgLyBkZWxpdmVyeU9yZGVycy5sZW5ndGhcbiAgfVxuICBcbiAgLy8gUHJvZHV0b3MgbWFpcyB2ZW5kaWRvc1xuICBjb25zdCBwcm9kdWN0c01hcCA9IG5ldyBNYXAoKVxuICBcbiAgZmlsdGVyZWRPcmRlcnMuZm9yRWFjaChvcmRlciA9PiB7XG4gICAgaWYgKG9yZGVyLml0ZW1zICYmIEFycmF5LmlzQXJyYXkob3JkZXIuaXRlbXMpKSB7XG4gICAgICBvcmRlci5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBjb25zdCBpZCA9IGl0ZW0uaWQgfHwgaXRlbS5wcm9kdWN0SWRcbiAgICAgICAgaWYgKCFwcm9kdWN0c01hcC5oYXMoaWQpKSB7XG4gICAgICAgICAgcHJvZHVjdHNNYXAuc2V0KGlkLCB7XG4gICAgICAgICAgICBfaWQ6IGlkLFxuICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lLFxuICAgICAgICAgICAgcXVhbnRpdHk6IDAsXG4gICAgICAgICAgICByZXZlbnVlOiAwXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgcHJvZHVjdCA9IHByb2R1Y3RzTWFwLmdldChpZClcbiAgICAgICAgcHJvZHVjdC5xdWFudGl0eSArPSBpdGVtLnF1YW50aXR5IHx8IDFcbiAgICAgICAgcHJvZHVjdC5yZXZlbnVlICs9IChpdGVtLnByaWNlICogKGl0ZW0ucXVhbnRpdHkgfHwgMSkpXG4gICAgICB9KVxuICAgIH1cbiAgfSlcbiAgXG4gIGNvbnN0IGJlc3RTZWxsaW5nUHJvZHVjdHMgPSBBcnJheS5mcm9tKHByb2R1Y3RzTWFwLnZhbHVlcygpKVxuICAgIC5zb3J0KChhLCBiKSA9PiBiLnF1YW50aXR5IC0gYS5xdWFudGl0eSlcbiAgICAuc2xpY2UoMCwgMTApXG4gICAgLm1hcCgoeyBfaWQsIC4uLnJlc3QgfSkgPT4gKHsgLi4ucmVzdCB9KSlcbiAgXG4gIC8vIEZhdHVyYW1lbnRvIHBvciBkaWFcbiAgY29uc3QgcmV2ZW51ZUJ5RGF5TWFwID0gbmV3IE1hcCgpXG4gIFxuICBmaWx0ZXJlZE9yZGVycy5mb3JFYWNoKG9yZGVyID0+IHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUob3JkZXIuY3JlYXRlZEF0KVxuICAgIGNvbnN0IGRhdGVTdHJpbmcgPSBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSAvLyBZWVlZLU1NLUREXG4gICAgXG4gICAgaWYgKCFyZXZlbnVlQnlEYXlNYXAuaGFzKGRhdGVTdHJpbmcpKSB7XG4gICAgICByZXZlbnVlQnlEYXlNYXAuc2V0KGRhdGVTdHJpbmcsIDApXG4gICAgfVxuICAgIFxuICAgIHJldmVudWVCeURheU1hcC5zZXQoZGF0ZVN0cmluZywgcmV2ZW51ZUJ5RGF5TWFwLmdldChkYXRlU3RyaW5nKSArIChvcmRlci50b3RhbCB8fCAwKSlcbiAgfSlcbiAgXG4gIGNvbnN0IHJldmVudWVCeURheSA9IEFycmF5LmZyb20ocmV2ZW51ZUJ5RGF5TWFwLmVudHJpZXMoKSlcbiAgICAubWFwKChbZGF0ZSwgdmFsdWVdKSA9PiAoeyBkYXRlLCB2YWx1ZSB9KSlcbiAgICAuc29ydCgoYSwgYikgPT4gYS5kYXRlLmxvY2FsZUNvbXBhcmUoYi5kYXRlKSlcbiAgXG4gIC8vIFBlZGlkb3MgcG9yIGhvcsOhcmlvXG4gIGNvbnN0IG9yZGVyc0J5SG91ck1hcCA9IG5ldyBNYXAoKVxuICBcbiAgZmlsdGVyZWRPcmRlcnMuZm9yRWFjaChvcmRlciA9PiB7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKG9yZGVyLmNyZWF0ZWRBdClcbiAgICBjb25zdCBob3VyID0gYCR7ZGF0ZS5nZXRIb3VycygpfWhgXG4gICAgXG4gICAgaWYgKCFvcmRlcnNCeUhvdXJNYXAuaGFzKGhvdXIpKSB7XG4gICAgICBvcmRlcnNCeUhvdXJNYXAuc2V0KGhvdXIsIDApXG4gICAgfVxuICAgIFxuICAgIG9yZGVyc0J5SG91ck1hcC5zZXQoaG91ciwgb3JkZXJzQnlIb3VyTWFwLmdldChob3VyKSArIDEpXG4gIH0pXG4gIFxuICBjb25zdCBvcmRlcnNCeUhvdXIgPSBBcnJheS5mcm9tKG9yZGVyc0J5SG91ck1hcC5lbnRyaWVzKCkpXG4gICAgLm1hcCgoW2hvdXIsIHF1YW50aXR5XSkgPT4gKHsgaG91ciwgcXVhbnRpdHkgfSkpXG4gICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIGNvbnN0IGhvdXJBID0gcGFyc2VJbnQoYS5ob3VyKVxuICAgICAgY29uc3QgaG91ckIgPSBwYXJzZUludChiLmhvdXIpXG4gICAgICByZXR1cm4gaG91ckEgLSBob3VyQlxuICAgIH0pXG4gIFxuICAvLyBSZXRvcm5hIHJlc3VsdGFkbyBmaW5hbFxuICByZXR1cm4ge1xuICAgIHRvdGFsT3JkZXJzLFxuICAgIHRvdGFsUmV2ZW51ZSxcbiAgICBhdmVyYWdlVGlja2V0LFxuICAgIGRlbGl2ZXJ5VGltZSxcbiAgICBiZXN0U2VsbGluZ1Byb2R1Y3RzLFxuICAgIHJldmVudWVCeURheSxcbiAgICBvcmRlcnNCeUhvdXJcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QmVzdFNlbGxpbmdQcm9kdWN0cyhyZXN0YXVyYW50SWQ6IHN0cmluZywgc3RhcnREYXRlOiBEYXRlLCBlbmREYXRlOiBEYXRlKSB7XG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGNsaWVudFByb21pc2VcbiAgY29uc3QgY29sbGVjdGlvbiA9IGNsaWVudC5kYignY2FyZGFwaW9fZGlnaXRhbCcpLmNvbGxlY3Rpb24oJ29yZGVycycpXG4gIFxuICByZXR1cm4gY29sbGVjdGlvbi5hZ2dyZWdhdGUoW1xuICAgIHtcbiAgICAgICRtYXRjaDoge1xuICAgICAgICByZXN0YXVyYW50SWQsXG4gICAgICAgIGNyZWF0ZWRBdDogeyAkZ3RlOiBzdGFydERhdGUsICRsdGU6IGVuZERhdGUgfSxcbiAgICAgICAgc3RhdHVzOiB7ICRuaW46IFsnY2FuY2VsbGVkJywgJ3JlamVjdGVkJ10gfVxuICAgICAgfVxuICAgIH0sXG4gICAgeyAkdW53aW5kOiAnJGl0ZW1zJyB9LFxuICAgIHtcbiAgICAgICRncm91cDoge1xuICAgICAgICBfaWQ6ICckaXRlbXMuaWQnLFxuICAgICAgICBuYW1lOiB7ICRmaXJzdDogJyRpdGVtcy5uYW1lJyB9LFxuICAgICAgICBxdWFudGl0eTogeyAkc3VtOiAnJGl0ZW1zLnF1YW50aXR5JyB9LFxuICAgICAgICByZXZlbnVlOiB7ICRzdW06IHsgJG11bHRpcGx5OiBbJyRpdGVtcy5wcmljZScsICckaXRlbXMucXVhbnRpdHknXSB9IH1cbiAgICAgIH1cbiAgICB9LFxuICAgIHsgJHNvcnQ6IHsgcXVhbnRpdHk6IC0xIH0gfSxcbiAgICB7ICRsaW1pdDogNSB9XG4gIF0pLnRvQXJyYXkoKVxufVxuXG4vLyBGdW7Dp8O1ZXMgcGFyYSBEYXNoYm9hcmRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREYXNoYm9hcmRTdGF0cyhyZXN0YXVyYW50SWQ6IHN0cmluZykge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlXG4gIGNvbnN0IG9yZGVyc0NvbGxlY3Rpb24gPSBjbGllbnQuZGIoJ2NhcmRhcGlvX2RpZ2l0YWwnKS5jb2xsZWN0aW9uKCdvcmRlcnMnKVxuICBcbiAgLy8gRGF0YSBkZSBob2plXG4gIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKVxuICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKVxuICBcbiAgLy8gUGVkaWRvcyBkZSBob2plXG4gIGNvbnN0IHRvZGF5T3JkZXJzID0gYXdhaXQgb3JkZXJzQ29sbGVjdGlvbi5jb3VudERvY3VtZW50cyh7XG4gICAgcmVzdGF1cmFudElkLFxuICAgIGNyZWF0ZWRBdDogeyAkZ3RlOiB0b2RheSB9XG4gIH0pXG5cbiAgLy8gUGVkaWRvcyBlbSBhbmRhbWVudG9cbiAgY29uc3QgYWN0aXZlT3JkZXJzID0gYXdhaXQgb3JkZXJzQ29sbGVjdGlvbi5jb3VudERvY3VtZW50cyh7XG4gICAgcmVzdGF1cmFudElkLFxuICAgIHN0YXR1czogeyAkaW46IFsncGVuZGluZycsICdjb25maXJtZWQnLCAncHJlcGFyaW5nJywgJ3JlYWR5JywgJ291dF9mb3JfZGVsaXZlcnknXSB9XG4gIH0pXG5cbiAgLy8gRmF0dXJhbWVudG8gZG8gZGlhXG4gIGNvbnN0IHRvZGF5UmV2ZW51ZSA9IGF3YWl0IG9yZGVyc0NvbGxlY3Rpb24uYWdncmVnYXRlKFtcbiAgICB7XG4gICAgICAkbWF0Y2g6IHtcbiAgICAgICAgcmVzdGF1cmFudElkLFxuICAgICAgICBjcmVhdGVkQXQ6IHsgJGd0ZTogdG9kYXkgfSxcbiAgICAgICAgc3RhdHVzOiB7ICRuaW46IFsnY2FuY2VsbGVkJywgJ3JlamVjdGVkJ10gfVxuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgJGdyb3VwOiB7XG4gICAgICAgIF9pZDogbnVsbCxcbiAgICAgICAgdG90YWw6IHsgJHN1bTogJyR0b3RhbCcgfVxuICAgICAgfVxuICAgIH1cbiAgXSkudG9BcnJheSgpXG5cbiAgLy8gVGlja2V0IG3DqWRpbyBkbyBkaWFcbiAgY29uc3QgYXZlcmFnZVRpY2tldCA9IHRvZGF5T3JkZXJzID4gMCA/ICh0b2RheVJldmVudWVbMF0/LnRvdGFsIHx8IDApIC8gdG9kYXlPcmRlcnMgOiAwXG5cbiAgLy8gQnVzY2FyIHBlZGlkb3MgcmVjZW50ZXNcbiAgY29uc3QgcmVjZW50T3JkZXJzID0gYXdhaXQgb3JkZXJzQ29sbGVjdGlvblxuICAgIC5maW5kKHsgcmVzdGF1cmFudElkIH0pXG4gICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pXG4gICAgLmxpbWl0KDUpXG4gICAgLnRvQXJyYXkoKVxuXG4gIC8vIEZvcm1hdGEgb3MgcGVkaWRvcyBwYXJhIHJldG9ybmFyXG4gIGNvbnN0IGZvcm1hdHRlZE9yZGVycyA9IHJlY2VudE9yZGVycy5tYXAob3JkZXIgPT4gKHtcbiAgICAuLi5vcmRlcixcbiAgICBpZDogb3JkZXIuX2lkLnRvU3RyaW5nKCksXG4gICAgX2lkOiB1bmRlZmluZWRcbiAgfSkpXG5cbiAgcmV0dXJuIHtcbiAgICB0b2RheU9yZGVycyxcbiAgICBhY3RpdmVPcmRlcnMsXG4gICAgdG9kYXlSZXZlbnVlOiB0b2RheVJldmVudWVbMF0/LnRvdGFsIHx8IDAsXG4gICAgYXZlcmFnZVRpY2tldCxcbiAgICByZWNlbnRPcmRlcnM6IGZvcm1hdHRlZE9yZGVyc1xuICB9XG59ICJdLCJuYW1lcyI6WyJPYmplY3RJZCIsImNsaWVudFByb21pc2UiLCJzdXBhYmFzZSIsImVtaXRUb1Jlc3RhdXJhbnQiLCJjb25uZWN0VG9EYXRhYmFzZSIsImdldENhdGVnb3JpZXMiLCJyZXN0YXVyYW50SWQiLCJjbGllbnQiLCJjb2xsZWN0aW9uIiwiZGIiLCJjb25zb2xlIiwibG9nIiwiY2F0ZWdvcmllcyIsImZpbmQiLCJzb3J0Iiwib3JkZXIiLCJ0b0FycmF5Iiwibm9ybWFsaXplZENhdGVnb3JpZXMiLCJtYXAiLCJjYXRlZ29yeSIsImlkIiwiX2lkIiwidG9TdHJpbmciLCJjcmVhdGVDYXRlZ29yeSIsIkVycm9yIiwicmVzdWx0IiwiaW5zZXJ0T25lIiwiY3JlYXRlZENhdGVnb3J5IiwiaW5zZXJ0ZWRJZCIsInVwZGF0ZUNhdGVnb3J5IiwiY2F0ZWdvcnlJZCIsInVwZGF0ZURhdGEiLCJleGlzdGluZ0NhdGVnb3J5IiwiZmluZE9uZSIsImVycm9yIiwiY2F0ZWdvcmlhUmVzdGF1cmFudElkIiwicmVxdWVzdFJlc3RhdXJhbnRJZCIsInVwZGF0ZURvYyIsIiRzZXQiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJ1cGRhdGVkQXQiLCJEYXRlIiwiZmluZE9uZUFuZFVwZGF0ZSIsInJldHVybkRvY3VtZW50IiwidXBkYXRlZERvYyIsInVwZGF0ZWRDYXRlZ29yeSIsImRlbGV0ZUNhdGVnb3J5IiwicHJvZHVjdHMiLCJwcm9kdWN0IiwiaW1hZ2UiLCJpbWFnZVVybCIsIlVSTCIsImltYWdlUGF0aCIsInBhdGhuYW1lIiwic3BsaXQiLCJzdG9yYWdlIiwiZnJvbSIsInJlbW92ZSIsImRlbGV0ZU1hbnkiLCJkZWxldGVPbmUiLCJnZXRQcm9kdWN0cyIsIm5vcm1hbGl6ZWRQcm9kdWN0cyIsInVuZGVmaW5lZCIsImdldFByb2R1Y3RzQnlDYXRlZ29yeSIsImNyZWF0ZVByb2R1Y3QiLCJub3JtYWxpemVkUHJvZHVjdCIsImF2YWlsYWJsZSIsImZlYXR1cmVkIiwiYWRkaXRpb25zIiwiaXNQaXp6YSIsImFsbG93SGFsZkhhbGYiLCJjcmVhdGVkQXQiLCJjcmVhdGVkUHJvZHVjdCIsInVwZGF0ZVByb2R1Y3QiLCJwcm9kdWN0SWQiLCJleGlzdGluZ1Byb2R1Y3QiLCJwcm9kdXRvUmVzdGF1cmFudElkIiwicHJpY2UiLCJ1cGRhdGVkUHJvZHVjdCIsImRlbGV0ZVByb2R1Y3QiLCJnZXRPcmRlcnMiLCJvcmRlcnMiLCJnZXRPcmRlciIsIml0ZW1zIiwiQXJyYXkiLCJpc0FycmF5IiwiZm9yRWFjaCIsIml0ZW0iLCJpbmRleCIsIk9iamVjdCIsImtleXMiLCJub3JtYWxpemVkT3JkZXIiLCJjcmVhdGVPcmRlciIsIm9yZGVyV2l0aFRpbWVzdGFtcCIsIm9yZGVyVHlwZSIsImRlbGl2ZXJ5TWV0aG9kIiwidG9JU09TdHJpbmciLCJjcmVhdGVkT3JkZXIiLCJ1cGRhdGVPcmRlclN0YXR1cyIsIm9yZGVySWQiLCJzdGF0dXMiLCJtZXNzYWdlIiwib2JqZWN0SWQiLCJ1cGRhdGVSZXN1bHQiLCJ1cGRhdGVPbmUiLCJtYXRjaGVkQ291bnQiLCJtb2RpZmllZENvdW50IiwidXBkYXRlZE9yZGVyIiwiZW1pdFJlc3VsdCIsImV2ZW50Iiwicm9vbSIsImdldE9yZGVyU3RhdHMiLCJzdGFydERhdGUiLCJlbmREYXRlIiwib3JkZXJzQ29sbGVjdGlvbiIsImFsbE9yZGVycyIsInN0YXJ0VGltZXN0YW1wIiwiZ2V0VGltZSIsImVuZFRpbWVzdGFtcCIsImZpbHRlcmVkT3JkZXJzIiwiZmlsdGVyIiwib3JkZXJEYXRlIiwib3JkZXJUaW1lc3RhbXAiLCJpbmNsdWRlcyIsImxlbmd0aCIsInRvdGFsT3JkZXJzIiwidG90YWxSZXZlbnVlIiwicmVkdWNlIiwic3VtIiwidG90YWwiLCJhdmVyYWdlVGlja2V0IiwiZGVsaXZlcnlPcmRlcnMiLCJvIiwic3RhdHVzVXBkYXRlcyIsImRlbGl2ZXJ5VGltZSIsInRvdGFsRGVsaXZlcnlUaW1lIiwibGFzdFVwZGF0ZSIsInRpbWVzdGFtcCIsInN0YXJ0IiwiZW5kIiwicHJvZHVjdHNNYXAiLCJNYXAiLCJoYXMiLCJzZXQiLCJxdWFudGl0eSIsInJldmVudWUiLCJnZXQiLCJiZXN0U2VsbGluZ1Byb2R1Y3RzIiwidmFsdWVzIiwiYSIsImIiLCJzbGljZSIsInJlc3QiLCJyZXZlbnVlQnlEYXlNYXAiLCJkYXRlIiwiZGF0ZVN0cmluZyIsInJldmVudWVCeURheSIsImVudHJpZXMiLCJ2YWx1ZSIsImxvY2FsZUNvbXBhcmUiLCJvcmRlcnNCeUhvdXJNYXAiLCJob3VyIiwiZ2V0SG91cnMiLCJvcmRlcnNCeUhvdXIiLCJob3VyQSIsInBhcnNlSW50IiwiaG91ckIiLCJnZXRCZXN0U2VsbGluZ1Byb2R1Y3RzIiwiYWdncmVnYXRlIiwiJG1hdGNoIiwiJGd0ZSIsIiRsdGUiLCIkbmluIiwiJHVud2luZCIsIiRncm91cCIsIiRmaXJzdCIsIiRzdW0iLCIkbXVsdGlwbHkiLCIkc29ydCIsIiRsaW1pdCIsImdldERhc2hib2FyZFN0YXRzIiwidG9kYXkiLCJzZXRIb3VycyIsInRvZGF5T3JkZXJzIiwiY291bnREb2N1bWVudHMiLCJhY3RpdmVPcmRlcnMiLCIkaW4iLCJ0b2RheVJldmVudWUiLCJyZWNlbnRPcmRlcnMiLCJsaW1pdCIsImZvcm1hdHRlZE9yZGVycyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/mongodb-services.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/mongodb.ts":
/*!****************************!*\
  !*** ./src/lib/mongodb.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   connectToDatabase: () => (/* binding */ connectToDatabase),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n\nif (!process.env.MONGODB_URI) {\n    throw new Error('Por favor, defina a variável de ambiente MONGODB_URI');\n}\nconst uri = process.env.MONGODB_URI;\nconst options = {};\nlet client;\nlet clientPromise;\nif (true) {\n    // Em desenvolvimento, use uma variável global para preservar o valor\n    // entre recarregamentos causados por Hot Reloading.\n    let globalWithMongo = global;\n    if (!globalWithMongo._mongoClientPromise) {\n        client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(uri, options);\n        globalWithMongo._mongoClientPromise = client.connect();\n    }\n    clientPromise = globalWithMongo._mongoClientPromise;\n} else {}\n// Função para conectar ao banco de dados\nasync function connectToDatabase() {\n    const client = await clientPromise;\n    const db = client.db('cardapio_digital');\n    return {\n        client,\n        db\n    };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (clientPromise);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21vbmdvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFxQztBQUVyQyxJQUFJLENBQUNDLFFBQVFDLEdBQUcsQ0FBQ0MsV0FBVyxFQUFFO0lBQzVCLE1BQU0sSUFBSUMsTUFBTTtBQUNsQjtBQUVBLE1BQU1DLE1BQU1KLFFBQVFDLEdBQUcsQ0FBQ0MsV0FBVztBQUNuQyxNQUFNRyxVQUFVLENBQUM7QUFFakIsSUFBSUM7QUFDSixJQUFJQztBQUVKLElBQUlQLElBQXNDLEVBQUU7SUFDMUMscUVBQXFFO0lBQ3JFLG9EQUFvRDtJQUNwRCxJQUFJUSxrQkFBa0JDO0lBSXRCLElBQUksQ0FBQ0QsZ0JBQWdCRSxtQkFBbUIsRUFBRTtRQUN4Q0osU0FBUyxJQUFJUCxnREFBV0EsQ0FBQ0ssS0FBS0M7UUFDOUJHLGdCQUFnQkUsbUJBQW1CLEdBQUdKLE9BQU9LLE9BQU87SUFDdEQ7SUFDQUosZ0JBQWdCQyxnQkFBZ0JFLG1CQUFtQjtBQUNyRCxPQUFPLEVBSU47QUFFRCx5Q0FBeUM7QUFDbEMsZUFBZUU7SUFDcEIsTUFBTU4sU0FBUyxNQUFNQztJQUNyQixNQUFNTSxLQUFLUCxPQUFPTyxFQUFFLENBQUM7SUFDckIsT0FBTztRQUFFUDtRQUFRTztJQUFHO0FBQ3RCO0FBRUEsaUVBQWVOLGFBQWFBLEVBQUEiLCJzb3VyY2VzIjpbIi9Vc2Vycy9vdGF2aW9tYXJjby9EZXNrdG9wL1Byb2pldG9zL0dsb2JhbCBMaXZlL2tyYXRvZGVsaXYvY2FyZGFwaW9fbGF0ZXN0L3NyYy9saWIvbW9uZ29kYi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNb25nb0NsaWVudCB9IGZyb20gJ21vbmdvZGInXG5cbmlmICghcHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkpIHtcbiAgdGhyb3cgbmV3IEVycm9yKCdQb3IgZmF2b3IsIGRlZmluYSBhIHZhcmnDoXZlbCBkZSBhbWJpZW50ZSBNT05HT0RCX1VSSScpXG59XG5cbmNvbnN0IHVyaSA9IHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJXG5jb25zdCBvcHRpb25zID0ge31cblxubGV0IGNsaWVudFxubGV0IGNsaWVudFByb21pc2U6IFByb21pc2U8TW9uZ29DbGllbnQ+XG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAvLyBFbSBkZXNlbnZvbHZpbWVudG8sIHVzZSB1bWEgdmFyacOhdmVsIGdsb2JhbCBwYXJhIHByZXNlcnZhciBvIHZhbG9yXG4gIC8vIGVudHJlIHJlY2FycmVnYW1lbnRvcyBjYXVzYWRvcyBwb3IgSG90IFJlbG9hZGluZy5cbiAgbGV0IGdsb2JhbFdpdGhNb25nbyA9IGdsb2JhbCBhcyB0eXBlb2YgZ2xvYmFsVGhpcyAmIHtcbiAgICBfbW9uZ29DbGllbnRQcm9taXNlPzogUHJvbWlzZTxNb25nb0NsaWVudD5cbiAgfVxuXG4gIGlmICghZ2xvYmFsV2l0aE1vbmdvLl9tb25nb0NsaWVudFByb21pc2UpIHtcbiAgICBjbGllbnQgPSBuZXcgTW9uZ29DbGllbnQodXJpLCBvcHRpb25zKVxuICAgIGdsb2JhbFdpdGhNb25nby5fbW9uZ29DbGllbnRQcm9taXNlID0gY2xpZW50LmNvbm5lY3QoKVxuICB9XG4gIGNsaWVudFByb21pc2UgPSBnbG9iYWxXaXRoTW9uZ28uX21vbmdvQ2xpZW50UHJvbWlzZVxufSBlbHNlIHtcbiAgLy8gRW0gcHJvZHXDp8Ojbywgw6kgbWVsaG9yIG7Do28gdXNhciB1bWEgdmFyacOhdmVsIGdsb2JhbC5cbiAgY2xpZW50ID0gbmV3IE1vbmdvQ2xpZW50KHVyaSwgb3B0aW9ucylcbiAgY2xpZW50UHJvbWlzZSA9IGNsaWVudC5jb25uZWN0KClcbn1cblxuLy8gRnVuw6fDo28gcGFyYSBjb25lY3RhciBhbyBiYW5jbyBkZSBkYWRvc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3RUb0RhdGFiYXNlKCkge1xuICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlXG4gIGNvbnN0IGRiID0gY2xpZW50LmRiKCdjYXJkYXBpb19kaWdpdGFsJylcbiAgcmV0dXJuIHsgY2xpZW50LCBkYiB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsaWVudFByb21pc2UgIl0sIm5hbWVzIjpbIk1vbmdvQ2xpZW50IiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfVVJJIiwiRXJyb3IiLCJ1cmkiLCJvcHRpb25zIiwiY2xpZW50IiwiY2xpZW50UHJvbWlzZSIsImdsb2JhbFdpdGhNb25nbyIsImdsb2JhbCIsIl9tb25nb0NsaWVudFByb21pc2UiLCJjb25uZWN0IiwiY29ubmVjdFRvRGF0YWJhc2UiLCJkYiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/mongodb.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/socket.ts":
/*!***************************!*\
  !*** ./src/lib/socket.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   emitToRestaurant: () => (/* binding */ emitToRestaurant),\n/* harmony export */   getSocketIO: () => (/* binding */ getSocketIO)\n/* harmony export */ });\n/* harmony import */ var socket_io__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io */ \"(rsc)/./node_modules/socket.io/wrapper.mjs\");\n/**\n * SocketService - Serviço de comunicação em tempo real\n * \n * Este serviço gerencia a comunicação em tempo real entre cliente e servidor\n * utilizando Socket.IO, permitindo atualizações instantâneas na interface.\n * \n * Responsabilidades:\n * - Gerenciar a instância do Socket.IO\n * - Emitir eventos para salas específicas (restaurantes)\n * - Abstrair a comunicação em tempo real para o resto da aplicação\n * - Lidar com diferenças entre cliente e servidor\n * \n * Uso típico:\n * - Notificações de novos pedidos\n * - Atualizações de status de pedidos\n * - Comunicação entre dashboard e cozinha\n */ \n// Função para obter a instância do Socket.IO\nconst getSocketIO = (res)=>{\n    if (res && res.socket && res.socket.server.io) {\n        return res.socket.server.io;\n    }\n    if (global.io) {\n        return global.io;\n    }\n    return null;\n};\n// Função para emitir eventos para um restaurante específico\nconst emitToRestaurant = (event, restaurantId, data)=>{\n    try {\n        console.log(`Socket: Tentando emitir evento ${event} para restaurante ${restaurantId}`, {\n            dataType: typeof data,\n            hasData: !!data,\n            isServer: \"undefined\" === 'undefined',\n            hasGlobalIo:  true && !!global.io\n        });\n        // Verifica se o restaurantId é válido\n        if (!restaurantId) {\n            console.error('Socket: restaurantId não fornecido para emissão de evento', {\n                event,\n                restaurantId\n            });\n            return false;\n        }\n        // Verifica se o Socket.IO está disponível globalmente\n        if ( true && global.io) {\n            try {\n                console.log(`Socket: Emitindo evento ${event} para restaurante ${restaurantId} (servidor)`);\n                global.io.to(restaurantId).emit(event, data);\n                return true;\n            } catch (serverEmitError) {\n                console.error('Socket: Erro ao emitir evento no servidor:', serverEmitError);\n                return false;\n            }\n        } else {\n            // No cliente, faz uma chamada para o endpoint interno\n            console.log(`Socket: Emitindo evento ${event} para restaurante ${restaurantId} (cliente)`);\n            // Usa Promise para permitir tratamento de erros assíncrono\n            const emitPromise = fetch('/api/socket', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    event,\n                    room: restaurantId,\n                    data\n                })\n            }).then((response)=>{\n                if (!response.ok) {\n                    console.error('Socket: Erro na resposta da API de socket', {\n                        status: response.status,\n                        statusText: response.statusText\n                    });\n                    return response.json().then((data)=>{\n                        throw new Error(`Erro na API: ${data.error || 'Desconhecido'}`);\n                    });\n                }\n                console.log(`Socket: Evento ${event} emitido com sucesso via API`);\n                return response.json();\n            }).catch((error)=>{\n                console.error('Socket: Erro ao chamar API de socket:', error);\n                throw error;\n            });\n            // Inicia a Promise mas não espera por ela (fire and forget)\n            emitPromise.catch((error)=>{\n                console.error('Socket: Erro não tratado na emissão do evento:', error);\n            });\n            return true;\n        }\n    } catch (error) {\n        console.error('Socket: Erro ao emitir evento via Socket.IO:', error);\n        return false;\n    }\n};\n/**\n * Inicializa o servidor Socket.IO\n * @param server - O servidor HTTP para anexar o Socket.IO\n * @returns A instância do Socket.IO inicializada\n */ const initSocket = (server)=>{\n    // Se já existir uma instância global, retorna-a\n    if (global.io) {\n        console.log('Socket.IO: Usando instância existente');\n        return global.io;\n    }\n    // Configura as origens permitidas para CORS\n    const allowedOrigins = process.env.ALLOWED_ORIGINS ? process.env.ALLOWED_ORIGINS.split(',') : [\n        'http://localhost:3000'\n    ];\n    console.log('Socket.IO: Inicializando com origens permitidas:', allowedOrigins);\n    // Cria uma nova instância do Socket.IO\n    const io = new socket_io__WEBPACK_IMPORTED_MODULE_0__.Server(server, {\n        cors: {\n            origin: allowedOrigins,\n            methods: [\n                'GET',\n                'POST'\n            ],\n            credentials: true\n        },\n        transports: [\n            'websocket',\n            'polling'\n        ]\n    });\n    // Configura os manipuladores de eventos\n    io.on('connection', (socket)=>{\n        console.log(`Socket.IO: Novo cliente conectado: ${socket.id}`);\n        // Evento para entrar em uma sala (restaurante)\n        socket.on('join-restaurant', (restaurantId)=>{\n            if (!restaurantId) {\n                console.error('Socket.IO: ID do restaurante não fornecido');\n                socket.emit('error', 'ID do restaurante não fornecido');\n                return;\n            }\n            socket.join(restaurantId);\n            console.log(`Socket.IO: Cliente ${socket.id} entrou na sala ${restaurantId}`);\n            socket.emit('joined', {\n                restaurantId,\n                socketId: socket.id\n            });\n        });\n        // Manipulador de eventos de desconexão\n        socket.on('disconnect', ()=>{\n            console.log(`Socket.IO: Cliente desconectado: ${socket.id}`);\n        });\n        // Manipulador de erros do socket\n        socket.on('error', (error)=>{\n            console.error(`Socket.IO: Erro no socket ${socket.id}:`, error);\n        });\n    });\n    // Armazena a instância na variável global\n    global.io = io;\n    console.log('Socket.IO: Servidor inicializado com sucesso');\n    return io;\n};\n// Exporta a função de inicialização como padrão\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (initSocket);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGNBQWM7WUFDdEJyQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxpQ0FBaUMsRUFBRVQsT0FBTzhDLEVBQUUsRUFBRTtRQUM3RDtRQUVBLGlDQUFpQztRQUNqQzlDLE9BQU82QyxFQUFFLENBQUMsU0FBUyxDQUFDL0I7WUFDbEJOLFFBQVFNLEtBQUssQ0FBQyxDQUFDLDBCQUEwQixFQUFFZCxPQUFPOEMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFaEM7UUFDM0Q7SUFDRjtJQUVBLDBDQUEwQztJQUMxQ1gsT0FBT0QsRUFBRSxHQUFHQTtJQUNaTSxRQUFRQyxHQUFHLENBQUM7SUFFWixPQUFPUDtBQUNUO0FBRUEsZ0RBQWdEO0FBQ2hELGlFQUFlZ0MsVUFBVUEsRUFBQSIsInNvdXJjZXMiOlsiL1VzZXJzL290YXZpb21hcmNvL0Rlc2t0b3AvUHJvamV0b3MvR2xvYmFsIExpdmUva3JhdG9kZWxpdi9jYXJkYXBpb19sYXRlc3Qvc3JjL2xpYi9zb2NrZXQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTb2NrZXRTZXJ2aWNlIC0gU2VydmnDp28gZGUgY29tdW5pY2HDp8OjbyBlbSB0ZW1wbyByZWFsXG4gKiBcbiAqIEVzdGUgc2VydmnDp28gZ2VyZW5jaWEgYSBjb211bmljYcOnw6NvIGVtIHRlbXBvIHJlYWwgZW50cmUgY2xpZW50ZSBlIHNlcnZpZG9yXG4gKiB1dGlsaXphbmRvIFNvY2tldC5JTywgcGVybWl0aW5kbyBhdHVhbGl6YcOnw7VlcyBpbnN0YW50w6JuZWFzIG5hIGludGVyZmFjZS5cbiAqIFxuICogUmVzcG9uc2FiaWxpZGFkZXM6XG4gKiAtIEdlcmVuY2lhciBhIGluc3TDom5jaWEgZG8gU29ja2V0LklPXG4gKiAtIEVtaXRpciBldmVudG9zIHBhcmEgc2FsYXMgZXNwZWPDrWZpY2FzIChyZXN0YXVyYW50ZXMpXG4gKiAtIEFic3RyYWlyIGEgY29tdW5pY2HDp8OjbyBlbSB0ZW1wbyByZWFsIHBhcmEgbyByZXN0byBkYSBhcGxpY2HDp8Ojb1xuICogLSBMaWRhciBjb20gZGlmZXJlbsOnYXMgZW50cmUgY2xpZW50ZSBlIHNlcnZpZG9yXG4gKiBcbiAqIFVzbyB0w61waWNvOlxuICogLSBOb3RpZmljYcOnw7VlcyBkZSBub3ZvcyBwZWRpZG9zXG4gKiAtIEF0dWFsaXphw6fDtWVzIGRlIHN0YXR1cyBkZSBwZWRpZG9zXG4gKiAtIENvbXVuaWNhw6fDo28gZW50cmUgZGFzaGJvYXJkIGUgY296aW5oYVxuICovXG5cbmltcG9ydCB7IFNlcnZlciBhcyBTb2NrZXRJT1NlcnZlciB9IGZyb20gJ3NvY2tldC5pbydcbmltcG9ydCB0eXBlIHsgU2VydmVyIGFzIEhUVFBTZXJ2ZXIgfSBmcm9tICdodHRwJ1xuaW1wb3J0IHR5cGUgeyBTb2NrZXQgYXMgTmV0U29ja2V0IH0gZnJvbSAnbmV0J1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0J1xuXG5pbnRlcmZhY2UgU29ja2V0U2VydmVyIGV4dGVuZHMgSFRUUFNlcnZlciB7XG4gIGlvPzogU29ja2V0SU9TZXJ2ZXIgfCB1bmRlZmluZWRcbn1cblxuaW50ZXJmYWNlIFNvY2tldFdpdGhJTyBleHRlbmRzIE5ldFNvY2tldCB7XG4gIHNlcnZlcjogU29ja2V0U2VydmVyXG59XG5cbmludGVyZmFjZSBOZXh0QXBpUmVzcG9uc2VXaXRoU29ja2V0IGV4dGVuZHMgTmV4dEFwaVJlc3BvbnNlIHtcbiAgc29ja2V0OiBTb2NrZXRXaXRoSU9cbn1cblxuLy8gVmFyacOhdmVsIGdsb2JhbCBwYXJhIGFybWF6ZW5hciBhIGluc3TDom5jaWEgZG8gU29ja2V0LklPXG5kZWNsYXJlIGdsb2JhbCB7XG4gIHZhciBpbzogU29ja2V0SU9TZXJ2ZXIgfCB1bmRlZmluZWRcbn1cblxuLy8gRnVuw6fDo28gcGFyYSBvYnRlciBhIGluc3TDom5jaWEgZG8gU29ja2V0LklPXG5leHBvcnQgY29uc3QgZ2V0U29ja2V0SU8gPSAocmVzPzogTmV4dEFwaVJlc3BvbnNlV2l0aFNvY2tldCk6IFNvY2tldElPU2VydmVyIHwgbnVsbCA9PiB7XG4gIGlmIChyZXMgJiYgcmVzLnNvY2tldCAmJiByZXMuc29ja2V0LnNlcnZlci5pbykge1xuICAgIHJldHVybiByZXMuc29ja2V0LnNlcnZlci5pb1xuICB9XG4gIFxuICBpZiAoZ2xvYmFsLmlvKSB7XG4gICAgcmV0dXJuIGdsb2JhbC5pb1xuICB9XG4gIFxuICByZXR1cm4gbnVsbFxufVxuXG4vLyBGdW7Dp8OjbyBwYXJhIGVtaXRpciBldmVudG9zIHBhcmEgdW0gcmVzdGF1cmFudGUgZXNwZWPDrWZpY29cbmV4cG9ydCBjb25zdCBlbWl0VG9SZXN0YXVyYW50ID0gKFxuICBldmVudDogc3RyaW5nLFxuICByZXN0YXVyYW50SWQ6IHN0cmluZyxcbiAgZGF0YTogYW55XG4pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhgU29ja2V0OiBUZW50YW5kbyBlbWl0aXIgZXZlbnRvICR7ZXZlbnR9IHBhcmEgcmVzdGF1cmFudGUgJHtyZXN0YXVyYW50SWR9YCwge1xuICAgICAgZGF0YVR5cGU6IHR5cGVvZiBkYXRhLFxuICAgICAgaGFzRGF0YTogISFkYXRhLFxuICAgICAgaXNTZXJ2ZXI6IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnLFxuICAgICAgaGFzR2xvYmFsSW86IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnICYmICEhZ2xvYmFsLmlvXG4gICAgfSlcbiAgICBcbiAgICAvLyBWZXJpZmljYSBzZSBvIHJlc3RhdXJhbnRJZCDDqSB2w6FsaWRvXG4gICAgaWYgKCFyZXN0YXVyYW50SWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1NvY2tldDogcmVzdGF1cmFudElkIG7Do28gZm9ybmVjaWRvIHBhcmEgZW1pc3PDo28gZGUgZXZlbnRvJywge1xuICAgICAgICBldmVudCxcbiAgICAgICAgcmVzdGF1cmFudElkXG4gICAgICB9KVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgIFxuICAgIC8vIFZlcmlmaWNhIHNlIG8gU29ja2V0LklPIGVzdMOhIGRpc3BvbsOtdmVsIGdsb2JhbG1lbnRlXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnICYmIGdsb2JhbC5pbykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coYFNvY2tldDogRW1pdGluZG8gZXZlbnRvICR7ZXZlbnR9IHBhcmEgcmVzdGF1cmFudGUgJHtyZXN0YXVyYW50SWR9IChzZXJ2aWRvcilgKVxuICAgICAgICBnbG9iYWwuaW8udG8ocmVzdGF1cmFudElkKS5lbWl0KGV2ZW50LCBkYXRhKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgfSBjYXRjaCAoc2VydmVyRW1pdEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NvY2tldDogRXJybyBhbyBlbWl0aXIgZXZlbnRvIG5vIHNlcnZpZG9yOicsIHNlcnZlckVtaXRFcnJvcilcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIE5vIGNsaWVudGUsIGZheiB1bWEgY2hhbWFkYSBwYXJhIG8gZW5kcG9pbnQgaW50ZXJub1xuICAgICAgY29uc29sZS5sb2coYFNvY2tldDogRW1pdGluZG8gZXZlbnRvICR7ZXZlbnR9IHBhcmEgcmVzdGF1cmFudGUgJHtyZXN0YXVyYW50SWR9IChjbGllbnRlKWApXG4gICAgICBcbiAgICAgIC8vIFVzYSBQcm9taXNlIHBhcmEgcGVybWl0aXIgdHJhdGFtZW50byBkZSBlcnJvcyBhc3PDrW5jcm9ub1xuICAgICAgY29uc3QgZW1pdFByb21pc2UgPSBmZXRjaCgnL2FwaS9zb2NrZXQnLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgIHJvb206IHJlc3RhdXJhbnRJZCxcbiAgICAgICAgICBkYXRhLFxuICAgICAgICB9KSxcbiAgICAgIH0pXG4gICAgICAudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdTb2NrZXQ6IEVycm8gbmEgcmVzcG9zdGEgZGEgQVBJIGRlIHNvY2tldCcsIHtcbiAgICAgICAgICAgIHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzcG9uc2Uuc3RhdHVzVGV4dFxuICAgICAgICAgIH0pXG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKS50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvIG5hIEFQSTogJHtkYXRhLmVycm9yIHx8ICdEZXNjb25oZWNpZG8nfWApXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhgU29ja2V0OiBFdmVudG8gJHtldmVudH0gZW1pdGlkbyBjb20gc3VjZXNzbyB2aWEgQVBJYClcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKVxuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NvY2tldDogRXJybyBhbyBjaGFtYXIgQVBJIGRlIHNvY2tldDonLCBlcnJvcilcbiAgICAgICAgdGhyb3cgZXJyb3JcbiAgICAgIH0pXG4gICAgICBcbiAgICAgIC8vIEluaWNpYSBhIFByb21pc2UgbWFzIG7Do28gZXNwZXJhIHBvciBlbGEgKGZpcmUgYW5kIGZvcmdldClcbiAgICAgIGVtaXRQcm9taXNlLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU29ja2V0OiBFcnJvIG7Do28gdHJhdGFkbyBuYSBlbWlzc8OjbyBkbyBldmVudG86JywgZXJyb3IpXG4gICAgICB9KVxuICAgICAgXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdTb2NrZXQ6IEVycm8gYW8gZW1pdGlyIGV2ZW50byB2aWEgU29ja2V0LklPOicsIGVycm9yKVxuICAgIHJldHVybiBmYWxzZVxuICB9XG59XG5cbi8qKlxuICogSW5pY2lhbGl6YSBvIHNlcnZpZG9yIFNvY2tldC5JT1xuICogQHBhcmFtIHNlcnZlciAtIE8gc2Vydmlkb3IgSFRUUCBwYXJhIGFuZXhhciBvIFNvY2tldC5JT1xuICogQHJldHVybnMgQSBpbnN0w6JuY2lhIGRvIFNvY2tldC5JTyBpbmljaWFsaXphZGFcbiAqL1xuY29uc3QgaW5pdFNvY2tldCA9IChzZXJ2ZXI6IEhUVFBTZXJ2ZXIpOiBTb2NrZXRJT1NlcnZlciA9PiB7XG4gIC8vIFNlIGrDoSBleGlzdGlyIHVtYSBpbnN0w6JuY2lhIGdsb2JhbCwgcmV0b3JuYS1hXG4gIGlmIChnbG9iYWwuaW8pIHtcbiAgICBjb25zb2xlLmxvZygnU29ja2V0LklPOiBVc2FuZG8gaW5zdMOibmNpYSBleGlzdGVudGUnKVxuICAgIHJldHVybiBnbG9iYWwuaW9cbiAgfVxuXG4gIC8vIENvbmZpZ3VyYSBhcyBvcmlnZW5zIHBlcm1pdGlkYXMgcGFyYSBDT1JTXG4gIGNvbnN0IGFsbG93ZWRPcmlnaW5zID0gcHJvY2Vzcy5lbnYuQUxMT1dFRF9PUklHSU5TIFxuICAgID8gcHJvY2Vzcy5lbnYuQUxMT1dFRF9PUklHSU5TLnNwbGl0KCcsJykgXG4gICAgOiBbJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCddXG5cbiAgY29uc29sZS5sb2coJ1NvY2tldC5JTzogSW5pY2lhbGl6YW5kbyBjb20gb3JpZ2VucyBwZXJtaXRpZGFzOicsIGFsbG93ZWRPcmlnaW5zKVxuXG4gIC8vIENyaWEgdW1hIG5vdmEgaW5zdMOibmNpYSBkbyBTb2NrZXQuSU9cbiAgY29uc3QgaW8gPSBuZXcgU29ja2V0SU9TZXJ2ZXIoc2VydmVyLCB7XG4gICAgY29yczoge1xuICAgICAgb3JpZ2luOiBhbGxvd2VkT3JpZ2lucyxcbiAgICAgIG1ldGhvZHM6IFsnR0VUJywgJ1BPU1QnXSxcbiAgICAgIGNyZWRlbnRpYWxzOiB0cnVlXG4gICAgfSxcbiAgICB0cmFuc3BvcnRzOiBbJ3dlYnNvY2tldCcsICdwb2xsaW5nJ11cbiAgfSlcblxuICAvLyBDb25maWd1cmEgb3MgbWFuaXB1bGFkb3JlcyBkZSBldmVudG9zXG4gIGlvLm9uKCdjb25uZWN0aW9uJywgKHNvY2tldCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBTb2NrZXQuSU86IE5vdm8gY2xpZW50ZSBjb25lY3RhZG86ICR7c29ja2V0LmlkfWApXG4gICAgXG4gICAgLy8gRXZlbnRvIHBhcmEgZW50cmFyIGVtIHVtYSBzYWxhIChyZXN0YXVyYW50ZSlcbiAgICBzb2NrZXQub24oJ2pvaW4tcmVzdGF1cmFudCcsIChyZXN0YXVyYW50SWQpID0+IHtcbiAgICAgIGlmICghcmVzdGF1cmFudElkKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NvY2tldC5JTzogSUQgZG8gcmVzdGF1cmFudGUgbsOjbyBmb3JuZWNpZG8nKVxuICAgICAgICBzb2NrZXQuZW1pdCgnZXJyb3InLCAnSUQgZG8gcmVzdGF1cmFudGUgbsOjbyBmb3JuZWNpZG8nKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIFxuICAgICAgc29ja2V0LmpvaW4ocmVzdGF1cmFudElkKVxuICAgICAgY29uc29sZS5sb2coYFNvY2tldC5JTzogQ2xpZW50ZSAke3NvY2tldC5pZH0gZW50cm91IG5hIHNhbGEgJHtyZXN0YXVyYW50SWR9YClcbiAgICAgIHNvY2tldC5lbWl0KCdqb2luZWQnLCB7IHJlc3RhdXJhbnRJZCwgc29ja2V0SWQ6IHNvY2tldC5pZCB9KVxuICAgIH0pXG4gICAgXG4gICAgLy8gTWFuaXB1bGFkb3IgZGUgZXZlbnRvcyBkZSBkZXNjb25leMOjb1xuICAgIHNvY2tldC5vbignZGlzY29ubmVjdCcsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBTb2NrZXQuSU86IENsaWVudGUgZGVzY29uZWN0YWRvOiAke3NvY2tldC5pZH1gKVxuICAgIH0pXG4gICAgXG4gICAgLy8gTWFuaXB1bGFkb3IgZGUgZXJyb3MgZG8gc29ja2V0XG4gICAgc29ja2V0Lm9uKCdlcnJvcicsIChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgU29ja2V0LklPOiBFcnJvIG5vIHNvY2tldCAke3NvY2tldC5pZH06YCwgZXJyb3IpXG4gICAgfSlcbiAgfSlcblxuICAvLyBBcm1hemVuYSBhIGluc3TDom5jaWEgbmEgdmFyacOhdmVsIGdsb2JhbFxuICBnbG9iYWwuaW8gPSBpb1xuICBjb25zb2xlLmxvZygnU29ja2V0LklPOiBTZXJ2aWRvciBpbmljaWFsaXphZG8gY29tIHN1Y2Vzc28nKVxuICBcbiAgcmV0dXJuIGlvXG59XG5cbi8vIEV4cG9ydGEgYSBmdW7Dp8OjbyBkZSBpbmljaWFsaXphw6fDo28gY29tbyBwYWRyw6NvXG5leHBvcnQgZGVmYXVsdCBpbml0U29ja2V0ICJdLCJuYW1lcyI6WyJTZXJ2ZXIiLCJTb2NrZXRJT1NlcnZlciIsImdldFNvY2tldElPIiwicmVzIiwic29ja2V0Iiwic2VydmVyIiwiaW8iLCJnbG9iYWwiLCJlbWl0VG9SZXN0YXVyYW50IiwiZXZlbnQiLCJyZXN0YXVyYW50SWQiLCJkYXRhIiwiY29uc29sZSIsImxvZyIsImRhdGFUeXBlIiwiaGFzRGF0YSIsImlzU2VydmVyIiwiaGFzR2xvYmFsSW8iLCJlcnJvciIsInRvIiwiZW1pdCIsInNlcnZlckVtaXRFcnJvciIsImVtaXRQcm9taXNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJyb29tIiwidGhlbiIsInJlc3BvbnNlIiwib2siLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwianNvbiIsIkVycm9yIiwiY2F0Y2giLCJpbml0U29ja2V0IiwiYWxsb3dlZE9yaWdpbnMiLCJwcm9jZXNzIiwiZW52IiwiQUxMT1dFRF9PUklHSU5TIiwic3BsaXQiLCJjb3JzIiwib3JpZ2luIiwibWV0aG9kcyIsImNyZWRlbnRpYWxzIiwidHJhbnNwb3J0cyIsIm9uIiwiaWQiLCJqb2luIiwic29ja2V0SWQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/socket.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://vvwihgsstdfoszepafgp.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2d2loZ3NzdGRmb3N6ZXBhZmdwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg3MjIyMTEsImV4cCI6MjA1NDI5ODIxMX0.orkmX9S4GRycZIQE_SilwIqD_Qxij2L85leHLLYYVs0\";\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQW9EO0FBRXBELE1BQU1DLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxrQkFBa0JILGtOQUF5QztBQUUxRCxNQUFNSyxXQUFXUCxtRUFBWUEsQ0FBQ0MsYUFBYUksaUJBQWdCIiwic291cmNlcyI6WyIvVXNlcnMvb3RhdmlvbWFyY28vRGVza3RvcC9Qcm9qZXRvcy9HbG9iYWwgTGl2ZS9rcmF0b2RlbGl2L2NhcmRhcGlvX2xhdGVzdC9zcmMvbGliL3N1cGFiYXNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcblxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhXG5jb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSFcblxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXkpICJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/ws","vendor-chunks/socket.io-parser","vendor-chunks/engine.io-parser","vendor-chunks/cookie","vendor-chunks/webidl-conversions","vendor-chunks/@socket.io","vendor-chunks/ms","vendor-chunks/supports-color","vendor-chunks/has-flag","vendor-chunks/engine.io","vendor-chunks/socket.io","vendor-chunks/socket.io-adapter","vendor-chunks/negotiator","vendor-chunks/mime-db","vendor-chunks/vary","vendor-chunks/object-assign","vendor-chunks/mime-types","vendor-chunks/cors","vendor-chunks/base64id","vendor-chunks/accepts"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fmongodb%2Froute&page=%2Fapi%2Fmongodb%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmongodb%2Froute.ts&appDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fotaviomarco%2FDesktop%2FProjetos%2FGlobal%20Live%2Fkratodeliv%2Fcardapio_latest&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();